<!DOCTYPE html><html> <head><meta charset="UTF-8"><meta name="description" content="Astro description"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.1.1"><title>ç½‘ç»œæµæœ€å¤§æµç®—æ³•æ€»ç»“ï¼ˆEdmonds-Karp ç®—æ³•+Dinic ç®—æ³•ï¼‰</title><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&display=swap"><!-- Matomo --><script>
      var _paq = (window._paq = window._paq || []);
      _paq.push(["trackPageView"]);
      _paq.push(["enableLinkTracking"]);
      (function () {
        var u = "//analytics.skywt.cn/";
        _paq.push(["setTrackerUrl", u + "matomo.php"]);
        _paq.push(["setSiteId", "1"]);
        var d = document,
          g = d.createElement("script"),
          s = d.getElementsByTagName("script")[0];
        g.async = true;
        g.src = u + "matomo.js";
        s.parentNode.insertBefore(g, s);
      })();
    </script><!-- End Matomo Code --><link rel="stylesheet" href="/_astro/about.42xRgEnE.css" />
<style>img[data-astro-cid-4sn4zg3r]{border-radius:.25rem;--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}
</style>
<link rel="stylesheet" href="/_astro/friends.hRKOKN_Z.css" /></head> <body> <header class="mt-12 wide-container" data-astro-cid-3ef6ksr2> <h5 class="mt-4 mx-4 secondary-color sm:hidden text-center" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> åšå®¢</a> </span><span>
/
ç½‘ç»œæµæœ€å¤§æµç®—æ³•æ€»ç»“ï¼ˆEdmonds-Karp ç®—æ³•+Dinic ç®—æ³•ï¼‰ </span> </h5> </header> <nav class="py-2 font-thin sticky top-0 backdrop-blur-md z-10 transition-all" id="navbar-wrapper" data-astro-cid-3ef6ksr2> <div class="wide-container flex justify-center sm:justify-between flex-wrap" data-astro-cid-3ef6ksr2> <h5 class="m-2 hidden sm:block secondary-color" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> åšå®¢</a> </span><span>
/
ç½‘ç»œæµæœ€å¤§æµç®—æ³•æ€»ç»“ï¼ˆEdmonds-Karp ç®—æ³•+Dinic ç®—æ³•ï¼‰ </span> </h5> <div class="m-2 secondary-color" data-astro-cid-3ef6ksr2> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> <i class="ri-home-line" data-astro-cid-tfcnbjmv></i>
ä¸»é¡µ
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv> <i class="ri-newspaper-line" data-astro-cid-tfcnbjmv></i> åšå®¢ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv> <i class="ri-server-line" data-astro-cid-tfcnbjmv></i> å®éªŒå®¤ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv> <i class="ri-contacts-line" data-astro-cid-tfcnbjmv></i> å‹äºº </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv> <i class="ri-cup-line" data-astro-cid-tfcnbjmv></i> å…³äº </a> </li> </ul>  </div> </div> </nav> <script>
  const headerEl = document.querySelector("#navbar-wrapper");
  const sentinalEl = document.querySelector("header");
  const handler = (entries) => {
    if (!entries[0].isIntersecting) {
      headerEl.classList.add("sticked");
    } else {
      headerEl.classList.remove("sticked");
    }
  };
  const observer = new window.IntersectionObserver(handler);
  observer.observe(sentinalEl);
</script>   <main data-astro-cid-4sn4zg3r> <section class="container mt-32" data-astro-cid-4sn4zg3r>  <h1 class="primary-color leading-relaxed" data-astro-cid-4sn4zg3r>ç½‘ç»œæµæœ€å¤§æµç®—æ³•æ€»ç»“ï¼ˆEdmonds-Karp ç®—æ³•+Dinic ç®—æ³•ï¼‰</h1> <p class="mt-4 secondary-color leading-relaxed" data-astro-cid-4sn4zg3r> <i class="ri-calendar-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>2018 å¹´ 03 æœˆ 25 æ—¥</span>   <br data-astro-cid-4sn4zg3r> <i class="ri-discuss-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>å…± 0 æ¡è¯„è®º</span>  </p> <hr class="my-8" data-astro-cid-4sn4zg3r> <p class="card p-2 my-8" data-astro-cid-4sn4zg3r>
âš™ï¸ å…¨æ–°åšå®¢å‰ç«¯ä»åœ¨æµ‹è¯•ä¸­ã€‚å¦‚æœæ–‡ç« æ˜¾ç¤ºä¸æ­£å¸¸ï¼Œå¯ä»¥å°è¯•è®¿é—®<a href="https://blog.skywt.cn/posts/network-flows" class="link underline" data-astro-cid-4sn4zg3r>åŸåšå®¢çš„è¿™ç¯‡æ–‡ç« </a>ã€‚
</p> <article class="prose dark:prose-neutral dark:prose-invert max-w-none" data-astro-cid-4sn4zg3r> <blockquote>ç½‘ç»œæµï¼ˆnetwork-flowsï¼‰æ˜¯ä¸€ç§ç±»æ¯”æ°´æµçš„è§£å†³é—®é¢˜æ–¹æ³•ï¼Œä¸çº¿æ€§è§„åˆ’å¯†åˆ‡ç›¸å…³ã€‚ç½‘ç»œæµçš„ç†è®ºå’Œåº”ç”¨åœ¨ä¸æ–­å‘å±•ï¼Œå‡ºç°äº†å…·æœ‰å¢ç›Šçš„æµã€å¤šç»ˆç«¯æµã€å¤šå•†å“æµä»¥åŠç½‘ç»œæµçš„åˆ†è§£ä¸åˆæˆç­‰æ–°è¯¾é¢˜ã€‚ç½‘ç»œæµçš„åº”ç”¨å·²éåŠé€šè®¯ã€è¿è¾“ã€ç”µåŠ›ã€å·¥ç¨‹è§„åˆ’ã€ä»»åŠ¡åˆ†æ´¾ã€è®¾å¤‡æ›´æ–°ä»¥åŠè®¡ç®—æœºè¾…åŠ©è®¾è®¡ç­‰ä¼—å¤šé¢†åŸŸã€‚</blockquote><p>ï¼ˆ2018.08.29 æ›´æ–°æ­¤æ–‡ï¼Œä½ æ²¡æœ‰é˜…è¯»è¿‡çš„èˆ¹æ–°ç‰ˆæœ¬ï¼‰</p><!--more--><p>ç½‘ç»œæµæ˜¯ä¿¡æ¯å­¦ç«èµ›ä¸­çš„å¸¸è§é¢˜å‹äº†ã€‚</p><h2>ç½‘ç»œæµçš„å®šä¹‰</h2><p>â€œç½‘ç»œæµï¼ˆnetwork-flowsï¼‰æ˜¯ä¸€ç§ç±»æ¯”æ°´æµçš„è§£å†³é—®é¢˜æ–¹æ³•ã€‚â€<br>å‡è®¾ç°åœ¨æœ‰ä¸€å¼ æœ‰é™çš„æœ‰å‘å›¾ Gï¼Œè¿™å¼ å›¾ä¸Šæœ‰ä¸€ä¸ªæºç‚¹ $s$ï¼Œä¸€ä¸ªæ±‡ç‚¹ $t$ï¼Œæ¯æ¡è¾¹éƒ½æœ‰ä¸€ä¸ªæœ€å¤§æµé‡ï¼ˆå³å®¹é‡ï¼‰ï¼Œå°±åƒå¤æ‚çš„æ°´ç®¡ç½‘ç»œã€‚ç°åœ¨æˆ‘ä»¬å®šä¹‰å‡ ä¸ªæ¦‚å¿µï¼š</p><ul><li><strong>æºç‚¹ï¼ˆSourcesï¼‰</strong>ï¼šä¸€åˆ‡æµé‡æµå…¥çš„ç‚¹ã€‚</li><li><strong>æ±‡ç‚¹ï¼ˆSinksï¼‰</strong>ï¼šæ‰€æœ‰æµé‡æœ€ç»ˆæ±‡èšåˆ°çš„ç‚¹ã€‚</li><li><strong>å®¹é‡ï¼ˆCapacityï¼‰</strong>ï¼šä¸€æ¡è¾¹çš„æœ€å¤§æµé‡ã€‚</li><li><strong>æ®‹é‡ï¼ˆResidual Capacityï¼‰</strong>ï¼šå®¹é‡ä¸æµé‡ä¹‹å·®ã€‚</li></ul><h2>ç½‘ç»œæµçš„ä¸‰å¤§åŸºæœ¬æ€§è´¨</h2><p>ç½‘ç»œæµä»»ä½•æ—¶åˆ»æ€»æ»¡è¶³ä»¥ä¸‹ä¸‰æ¡æ€§è´¨ï¼š<br><strong>1. å®¹é‡é™åˆ¶ï¼ˆCapacity Constraintsï¼‰</strong>ï¼š$f(u,v)â‰¤c(u,v)$ï¼Œå³ä¸€æ¡è¾¹çš„æµä¸èƒ½è¶…è¿‡å®ƒçš„å®¹é‡ã€‚ï¼ˆä¸ç„¶æ°´ç®¡å°±è¦è¢«æŒ¤çˆ†äº†â€¦â€¦ï¼‰<br><strong>2. æ–œå¯¹ç§°ï¼ˆSkew Symmetryï¼‰</strong>ï¼š$f(u,v)=-f(v,u)$ï¼Œå³ç”± $u$ åˆ° $v$ çš„å‡€æµå¿…é¡»æ˜¯ç”± $v$ åˆ° $u$ çš„å‡€æµçš„ç›¸åã€‚å‡è®¾æœ‰ $x$ çš„æµé‡ä» $u$ æµåˆ° $v$ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºæœ‰ $-x$ çš„æµé‡ä» $v$ æµåˆ° $u$ã€‚<br><strong>3. æµå®ˆæ’ï¼ˆFlow Conservationï¼‰</strong>ï¼šå¯¹äºé™¤äº†æºç‚¹ $s$ å’Œæ±‡ç‚¹ $t$ ä»¥å¤–çš„æ‰€æœ‰ç‚¹ï¼Œéƒ½æ»¡è¶³ï¼š</p><pre><code class="lang-math">\displaystyle \sum_{p\in G} f(p,u)= \sum_{q\in G} f(u,q)</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ä»»ä½•ä¸€ä¸ªç‚¹çš„å…¥æµç­‰äºå…¶å‡ºæµï¼Œæºç‚¹å’Œæ±‡ç‚¹é™¤å¤–ã€‚</p><h2>æœ€å¤§æµé—®é¢˜</h2><p>ç°åœ¨å‡è®¾æœ‰æ— é™çš„æµé‡ä»æºç‚¹ $s$ æµå…¥ï¼Œæˆ‘ä»¬è¦æ±‚å‡ºæœ€åæµåˆ°æ±‡ç‚¹tçš„æœ€å¤§æµé‡ï¼ˆæ³¨æ„ä»»ä½•æ—¶å€™ä¸Šé¢ä¸‰ä¸ªæ¡ä»¶éƒ½è¦æ»¡è¶³ï¼‰ã€‚<br>å¯¹äºæœ€å¤§æµé—®é¢˜å¯ä»¥ç”¨ Edmonds-Karp ç®—æ³•æˆ– Dinic ç®—æ³•è§£å†³ã€‚åè€…æ˜¯å‰è€…çš„ä¼˜åŒ–ï¼Œä½†æ˜¯å‰è€…æ›´æ˜“äºç†è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆäº†è§£ Edmonds-Karp ç®—æ³•ã€‚</p><h3>Edmonds-Karp ç®—æ³•</h3><p>Edmonds-Karp ç®—æ³•ï¼ˆç®€ç§°EKï¼‰çš„ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>æ‰¾åˆ°ä¸€æ¡æºç‚¹åˆ°æ±‡ç‚¹çš„è·¯å¾„ï¼ˆå…¶ä¸­æ¯æ¡è¾¹æ®‹é‡éƒ½è¦å¤§äº0ï¼‰ï¼ˆè¿™æ ·çš„è·¯å¾„å°±æ˜¯<strong>å¢å¹¿è·¯ï¼ˆAugmenting Pathï¼‰</strong>ï¼‰ï¼Œå¹¶æ‰¾å‡ºè¿™æ¡è·¯å¾„ä¸Šæ¯æ¡è¾¹æ®‹é‡æœ€å°å€¼ $min$ï¼›</li><li>å°†è¿™æ¡è·¯å¾„ä¸Šæ¯æ¡è¾¹æ®‹é‡å‡å» minï¼Œå°†æ¯æ¡è¾¹çš„åå‘è¾¹åŠ ä¸Š $min$ï¼ˆå› ä¸ºæˆ‘ä»¬è¿™æ¡å¢å¹¿è·¯æ˜¯â€œéšä¾¿æ‰¾â€çš„ï¼Œä¸èƒ½ä¿è¯è§£æœ€ä¼˜ï¼›å°†åå‘è¾¹åŠ ä¸Š $min$ ç›¸å½“äºæä¾›äº†â€œåæ‚”â€çš„æœºä¼šï¼‰ï¼Œå¹¶å°†ç­”æ¡ˆç´¯è®¡ä¸Š $min$ï¼›</li><li>é‡å¤ä»¥ä¸Šè¿‡ç¨‹ï¼Œç›´åˆ°ä» $s$ åˆ° $t$ æ²¡æœ‰å¢å¹¿è·¯ä¸ºæ­¢ã€‚</li></ol><p>ï¼ˆç”±äº<del>æˆ‘å¤ªæ‡’</del>EKç®—æ³•ä¼¼ä¹åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½æ²¡æœ‰ä¼˜åŒ–äº†çš„ Dinic å¥½ï¼Œè¿™é‡Œå°±ä¸ç»™å‡ºä»£ç äº†â€¦â€¦ï¼‰</p><h4>å¦‚ä½•å­˜å‚¨è¾¹</h4><p>è¦å¿«é€ŸåˆèŠ‚çœç©ºé—´åœ°æ±‚å‡ºä¸€æ¡è¾¹çš„åå‘è¾¹å¹¶ä¸ç®€å•ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨é‚»æ¥è¡¨å­˜å‚¨ï¼šåœ¨è¯»å–è¾¹çš„ä¿¡æ¯çš„åŒæ—¶ï¼Œ<code>add(x,y,z)</code>ï¼Œ<code>add(y,x,0)</code>ï¼Œè¿™æ ·ä¸€æ¡è¾¹ä¸å…¶ç›¸é‚»è¾¹çš„è¾¹å·æ€»æ˜¯ç›¸é‚»ã€‚æˆ‘ä»¬å¦‚æœ<strong>ä»0å¼€å§‹å­˜å‚¨è¾¹å·</strong>ï¼Œé‚£ä¹ˆiçš„ç›¸é‚»è¾¹å°±æ˜¯i^1ï¼Œå°±æ˜¯å®ƒçš„åå‘è¾¹ï¼ï¼ˆ^è¡¨ç¤ºå¼‚æˆ–ï¼‰</p><h3>Dinic ç®—æ³•</h3><p>Dinic ç®—æ³•æ˜¯å¯¹ Edmonds-Karp çš„ä¼˜åŒ–ã€‚</p><h4>Edmonds-Karp æ…¢åœ¨å“ªé‡Œ</h4><p>å› ä¸º EK ç®—æ³•ä¸­èµ°åˆ°å„ä¸ªç‚¹æ²¡æœ‰ä¸€å®šçš„é¡ºåºï¼Œå¯ä»¥ç†è§£ä¸ºâ€œä»»æ„â€çš„ï¼Œæ‰€ä»¥ä¼šå‡ºç°ä¸€å®šçš„é—®é¢˜ã€‚å‡è®¾ä» $s$ æœ‰ä¸¤æ¡è·¯å¾„èµ°åˆ° $x$ï¼ˆå‡è®¾ $x$ æ˜¯å¢å¹¿è·¯ä¸Šçš„ä¸€ä¸ªç‚¹ï¼‰ï¼Œå‡è®¾è¿™ä¸¤æ¡è·¯å¾„ä¸­æœ€å°çš„æ®‹é‡åˆ†åˆ«ä¸º $min1$ã€$min2$ï¼Œå¦‚æœ $min2$ æ›´å¤§ï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹© $min2$ è¿™æ¡è·¯å¾„ï¼Œä½†æ˜¯æ ¹æ® EK çš„å¤„ç†æ–¹æ³•æˆ‘ä»¬ä¼šé€‰æ‹© $min1$ï¼Œè¿™æ ·ä¼šå¯¼è‡´é‡å¤å¤„ç†ã€‚æ‰€ä»¥ EK ç®—æ³•å°±ä¼šæ…¢ã€‚</p><p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼ŸDinic ç®—æ³•å¼•å…¥äº†â€œåˆ†å±‚å›¾â€è¿™ä¸ªä¸œè¥¿ã€‚</p><h4>åˆ†å±‚å›¾</h4><p>å¯¹äº $s$ å¼€å§‹é€šè¿‡ BFS æ„é€ åˆ†å±‚å›¾ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ—¥å DFS ä½¿ç”¨çš„ä» $s$ åˆ°è¾¾ $x$ çš„è·¯å¾„éƒ½æ˜¯â€œæœ€çŸ­è·¯â€ï¼ˆä¹Ÿå°±æ˜¯æœ€ä¼˜è·¯å¾„ï¼‰ã€‚</p><h4>Dinic ç®—æ³•æ ¸å¿ƒä»£ç </h4><pre><code class="lang-cpp">inline bool BFS(){//è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ„é€ åˆ†å±‚å›¾åŒæ—¶è¿”å›æœ‰æ— å¢å¹¿è·¯ 
    memset(deep,0,sizeof(deep));
    deep[s]=1;//æºç‚¹çš„æ·±åº¦ä¸º1 
    int head=0,tail=1;que[tail]=s;
    while (head!=tail){
        head++;
        for (int i=lnk[que[head]];i!=-1;i=nxt[i]) if (w[i]&gt;0&amp;&amp;deep[son[i]]==0) deep[son[i]]=deep[que[head]]+1,que[++tail]=son[i];
    }
    if (deep[t]==0) return 0;//å¦‚æœæ±‡ç‚¹æ·±åº¦ä¸º0è¯´æ˜æ²¡æœ‰è¢«ä¿®æ­£åˆ°ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰å¢å¹¿è·¯ 
    return 1;
}
inline int DFS(int x,int now){//xä¸ºå½“å‰ç‚¹ï¼Œnowä¸ºå½“å‰æµé‡ 
    if (x==t) return now;
    for (int i=cur[x];i!=-1;i=cur[x]=nxt[i]) if (deep[son[i]]==deep[x]+1&amp;&amp;w[i]!=0){
        int nxtd=DFS(son[i],min(now,w[i]));
        if (nxtd&gt;0){
            w[i]-=nxtd;
            w[i^1]+=nxtd;//åå‘è¾¹åŠ   
            return nxtd;//å‘ä¸Šä¼ é€’ 
        }
    }
    return 0;
}
inline void Dinic(){
    while (BFS()){
        for (int i=1;i&lt;=n;i++) cur[i]=lnk[i];
        while (int now=DFS(s,1&lt;&lt;30)) ans+=now;//åˆå§‹æµé‡ä¸ºæ­£æ— ç©· 
    }
}</code></pre><h4>å½“å‰å¼§ä¼˜åŒ–</h4><p>Dinic ç®—æ³•ä»ç„¶å¯ä»¥ä¼˜åŒ–ï¼Œè¿™ä¸ªä¼˜åŒ–ç§°ä¸ºâ€œå½“å‰å¼§ä¼˜åŒ–â€ã€‚åŸºäºè¿™æ ·ä¸€ä¸ªäº‹å®ï¼šä»»ä½•ä¸€æ¡å¢å¹¿è·¯ä¸­ä¸€æ¡è¾¹ä¸ä¼šå­˜åœ¨ä¸¤æ¬¡ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åŠ ä¸€ä¸ªæ•°ç»„ <code>cur[x]</code> è¡¨ç¤ºå½“å‰ $x$ è¿™ä¸ªç‚¹å¾ªç¯åˆ°çš„è¾¹ã€‚ï¼ˆå…·ä½“å‚è§å®Œæ•´ä»£ç ï¼‰</p><h4>å®Œæ•´ä»£ç ï¼ˆå«å½“å‰å¼§ä¼˜åŒ–ï¼‰</h4><p>ï¼ˆæ´›è°·æ¨¡ç‰ˆé¢˜â€œæœ€å¤§ç½‘ç»œæµâ€ï¼ˆ<a href="https://www.luogu.org/problemnew/show/P3376" title="P3376">P3376</a>ï¼‰æµ‹è¯„é€šè¿‡ï¼‰</p><pre><code class="lang-cpp">#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;iostream&gt;
#include&lt;algorithm&gt;
using namespace std;
const int maxn=10005,maxe=200005;
int n,m,s,t,tot=-1,ans=0,nxt[maxe],son[maxe],w[maxe],deep[maxn],lnk[maxn],que[maxn],cur[maxn];
inline int read(){
    int ret=0,f=1;char ch=getchar();
    while (ch&lt;'0'||ch&gt;'9') {if (ch=='-') f=-1;ch=getchar();}
    while (ch&gt;='0'&amp;&amp;ch&lt;='9') ret=ret*10+ch-'0',ch=getchar();
    return ret*f;
}
inline void add(int x,int y,int z){
    tot++;son[tot]=y;w[tot]=z;nxt[tot]=lnk[x];lnk[x]=tot;
}
inline bool BFS(){//è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ„é€ åˆ†å±‚å›¾åŒæ—¶è¿”å›æœ‰æ— å¢å¹¿è·¯ 
    memset(deep,0,sizeof(deep));
    deep[s]=1;//æºç‚¹çš„æ·±åº¦ä¸º1 
    int head=0,tail=1;que[tail]=s;
    while (head!=tail){
        head++;
        for (int i=lnk[que[head]];i!=-1;i=nxt[i]) if (w[i]&gt;0&amp;&amp;deep[son[i]]==0) deep[son[i]]=deep[que[head]]+1,que[++tail]=son[i];
    }
    if (deep[t]==0) return 0;//å¦‚æœæ±‡ç‚¹æ·±åº¦ä¸º0è¯´æ˜æ²¡æœ‰è¢«ä¿®æ­£åˆ°ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰å¢å¹¿è·¯ 
    return 1;
}
inline int DFS(int x,int now){//xä¸ºå½“å‰ç‚¹ï¼Œnowä¸ºå½“å‰æµé‡ 
    if (x==t) return now;
    for (int i=cur[x];i!=-1;i=cur[x]=nxt[i]) if (deep[son[i]]==deep[x]+1&amp;&amp;w[i]!=0){
        int nxtd=DFS(son[i],min(now,w[i]));
        if (nxtd&gt;0){
            w[i]-=nxtd;
            w[i^1]+=nxtd;//åå‘è¾¹åŠ   
            return nxtd;//å‘ä¸Šä¼ é€’ 
        }
    }
    return 0;
}
inline void Dinic(){
    while (BFS()){
        for (int i=1;i&lt;=n;i++) cur[i]=lnk[i];
        while (int now=DFS(s,1&lt;&lt;30)) ans+=now;//åˆå§‹æµé‡ä¸ºæ­£æ— ç©· 
    }
}
int main(){
    memset(lnk,-1,sizeof(lnk));//å› ä¸ºè¾¹å·ä»0å¼€å§‹å­˜å‚¨ï¼Œæ‰€ä»¥-1è¡¨ç¤ºæ²¡æœ‰è¾¹ 
    memset(nxt,-1,sizeof(nxt));
    n=read();m=read();s=read();t=read();
    for (int i=1;i&lt;=m;i++){
        int x=read(),y=read(),z=read();
        add(x,y,z);add(y,x,0);//æ„é€ åå‘è¾¹å¹¶ä¸”å…¶è¾¹å·ä¸æ­£å‘è¾¹ç›¸é‚» 
    }
    Dinic();
    printf(&quot;%d\n&quot;,ans);
    return 0;
}</code></pre><h3>æ¨¡æ¿é¢˜</h3><p><a href="https://www.luogu.org/problemnew/show/P3376" title="æ´›è°·3376">æ´›è°·3376</a><br><a href="http://poj.org/problem?id=1273" title="POJ1273">POJ1273</a></p><hr><h2>å‚è€ƒ</h2><p><a href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E6%B5%81" title="ç½‘ç»œæµ_ç™¾åº¦ç™¾ç§‘">ç½‘ç»œæµ_ç™¾åº¦ç™¾ç§‘</a><br><a href="https://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C%E6%B5%81" title="ç½‘ç»œæµ - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦">ç½‘ç»œæµ - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦</a><br><a href="https://www.cnblogs.com/SYCstudio/p/7260613.html" title="Dinicç®—æ³•ï¼ˆç ”ç©¶æ€»ç»“ï¼Œç½‘ç»œæµï¼‰">Dinicç®—æ³•ï¼ˆç ”ç©¶æ€»ç»“ï¼Œç½‘ç»œæµï¼‰</a><br><a href="https://blog.csdn.net/dyt_b/article/details/79307596" title="ç½‘ç»œæµç®—æ³•+ä¾‹é¢˜æ•´ç† - CSDNåšå®¢">ç½‘ç»œæµç®—æ³•+ä¾‹é¢˜æ•´ç† - CSDNåšå®¢</a><br><a href="https://blog.csdn.net/qq_41357771/article/details/79416899" title="ç½‘ç»œæµã€æœ€å¤§æµ&amp;&amp;æœ€å°å‰²ã€‘â€”â€”ä¸€ç¯‡ç®€å•æ˜“æ‡‚çš„åšæ–‡">ç½‘ç»œæµã€æœ€å¤§æµ&&æœ€å°å‰²ã€‘â€”â€”ä¸€ç¯‡ç®€å•æ˜“æ‡‚çš„åšæ–‡</a><br><a href="http://www.matrix67.com/blog/archives/5190" title="ç½‘ç»œæµå’Œæ£’çƒèµ›æ·˜æ±°é—®é¢˜ | Matrix67: The Aha Moments">ç½‘ç»œæµå’Œæ£’çƒèµ›æ·˜æ±°é—®é¢˜ | Matrix67: The Aha Moments</a></p> </article> <hr class="my-8" data-astro-cid-4sn4zg3r> <h2> <i class="ri-discuss-line"></i> å…± 0 æ¡è¯„è®º </h2>  <hr class="my-8"> <h2> <i class="ri-discuss-line"></i>
å‘è¡¨è¯„è®º
</h2> <p class="primary-color card my-4 p-2">
ğŸš§ æ–°åšå®¢ç³»ç»Ÿçš„è¯„è®ºåŠŸèƒ½ä»åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ã€‚å¯ä»¥å‰å¾€<a href="https://blog.skywt.cn/posts/network-flows" class="link underline">åŸåšå®¢çš„è¿™ç¯‡æ–‡ç« </a>åº•éƒ¨è¯„è®ºåŒºå‘è¡¨è¯„è®ºã€‚
</p> </section> </main>  <footer class="mt-16 py-8 bg-gray-100 dark:bg-neutral-900"> <div class="wide-container secondary-color text-sm"> <div class="flex justify-between flex-wrap"> <div class="m-2"> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> åšå®¢</a> </span><span>
/
ç½‘ç»œæµæœ€å¤§æµç®—æ³•æ€»ç»“ï¼ˆEdmonds-Karp ç®—æ³•+Dinic ç®—æ³•ï¼‰ </span> </div> <div class="m-2"> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> 
ä¸»é¡µ
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv>  åšå®¢ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv>  å®éªŒå®¤ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv>  å‹äºº </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv>  å…³äº </a> </li> </ul>  </div> </div> <hr class="my-4"> <div class="flex justify-between flex-wrap"> <p class="m-2">
&#169; 2017-2024 <a href="/" class="link">SkyWT</a>
|
<a href="/sitemap.xml" class="link">ç«™ç‚¹åœ°å›¾</a>
|
<a href="/friends" class="link">å‹æƒ…é“¾æ¥</a>
|
<a href="https://foreverblog.cn/go.html" class="link">è™«æ´</a> <!-- |
        <a href="https://github.com/Skywt2003/Daydreamer" class="link"
          >Daydreamer</a
        > --> </p> <div class="m-2"> <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" class="inline-block mx-1" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/cc.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/by.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/nc.svg" data-astro-cid-h3ykra2n>   </a>  <a href="https://notbyai.fyi" target="_blank" class="inline-block mx-1" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-light.svg" alt="Not By AI Badge" class="badge inline-block dark:hidden" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-dark.svg" alt="Not By AI Badge" class="badge hidden dark:inline-block" data-astro-cid-hwbnc4sm> </a>  <a href="https://www.foreverblog.cn/" target="_blank" class="inline-block mx-1"> <img src="https://img.foreverblog.cn/logo_en_default.png" alt="Forever Blog Badage" class="inline-block h-4 grayscale"> </a> </div> </div> <div class="flex justify-between flex-wrap"> <p class="m-2"> <a href="https://beian.miit.gov.cn/" target="_blank" class="link">
æµ™ ICP å¤‡ 2021019606 å· - 1</a>
|
<a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33080202000472" target="_blank" class="link before:content-[url('/mps.png')] before:align-middle">
æµ™å…¬ç½‘å®‰å¤‡ 33080202000472 å·</a> </p> <p class="m-2"> <span class="align-middle">ç”±</span> <a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" class="inline-block align-middle"> <img src="/upyun.png" class="h-6"> </a> <span class="align-middle">æä¾› CDN åŠ é€Ÿã€äº‘å­˜å‚¨æœåŠ¡</span> </p> </div> </div> </footer> </body></html> 