<!DOCTYPE html><html> <head><meta charset="UTF-8"><meta name="description" content="Astro description"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.1.1"><title>CSAPP 2e Datalab é¢˜è§£</title><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&display=swap"><script>
      function addMatomo() {
        var _paq = (window._paq = window._paq || []);
        _paq.push(["trackPageView"]);
        _paq.push(["enableLinkTracking"]);
        (function () {
          var u = "//analytics.skywt.cn/";
          _paq.push(["setTrackerUrl", u + "matomo.php"]);
          _paq.push(["setSiteId", "1"]);
          var d = document,
            g = d.createElement("script"),
            s = d.getElementsByTagName("script")[0];
          g.async = true;
          g.src = u + "matomo.js";
          s.parentNode.insertBefore(g, s);
        })();
      }

      document.addEventListener(
        "astro:page-load",
        () => {
          addMatomo();
        },
        { once: false },
      );
    </script><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/about.QtYNSWJd.css" />
<style>img[data-astro-cid-4sn4zg3r]{border-radius:.25rem;--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}
</style>
<link rel="stylesheet" href="/_astro/friends.0bZnSjYD.css" /><script type="module" src="/_astro/hoisted.-OpaiJNX.js"></script></head> <body> <header class="mt-12 wide-container" data-astro-cid-3ef6ksr2> <h5 class="mt-4 mx-4 secondary-color sm:hidden text-center" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> åšå®¢</a> </span><span>
/
CSAPP 2e Datalab é¢˜è§£ </span> </h5> </header> <nav class="py-2 font-thin sticky top-0 backdrop-blur-md z-10 transition-all" id="navbar-wrapper" data-astro-cid-3ef6ksr2> <div class="wide-container flex justify-center sm:justify-between flex-wrap" data-astro-cid-3ef6ksr2> <h5 class="m-2 hidden sm:block secondary-color" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> åšå®¢</a> </span><span>
/
CSAPP 2e Datalab é¢˜è§£ </span> </h5> <div class="m-2 secondary-color" data-astro-cid-3ef6ksr2> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> <i class="ri-home-line" data-astro-cid-tfcnbjmv></i>
ä¸»é¡µ
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv> <i class="ri-newspaper-line" data-astro-cid-tfcnbjmv></i> åšå®¢ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv> <i class="ri-server-line" data-astro-cid-tfcnbjmv></i> å®éªŒå®¤ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv> <i class="ri-contacts-line" data-astro-cid-tfcnbjmv></i> å‹äºº </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv> <i class="ri-cup-line" data-astro-cid-tfcnbjmv></i> å…³äº </a> </li> </ul>  </div> </div> </nav> <script>
  // ä½¿ç”¨ ViewTransition åï¼Œæ‰€æœ‰ DOM æ“ä½œçš„ js éƒ½æœ‰ä¸€å †é—®é¢˜
  // è¿™é‡Œç”¨äº†æä¸ä¼˜é›…çš„ varï¼Œæœ‰å¾…æ”¹è¿›
  var observer;
  function addNavObserver() {
    const headerEl = document.querySelector("#navbar-wrapper");
    const sentinalEl = document.querySelector("header");
    if (!sentinalEl || !headerEl) return;
    observer = new window.IntersectionObserver((e) => {
      if (!e[0].isIntersecting) {
        headerEl.classList.add("sticked");
      } else {
        headerEl.classList.remove("sticked");
      }
    });
    observer.observe(sentinalEl);
  }

  function removeNavObserver() {
    if (observer) observer.disconnect();
    observer = null;
  }

  document.addEventListener(
    "astro:page-load",
    () => {
      addNavObserver();
    },
    { once: false },
  );

  document.addEventListener(
    "astro:before-swap",
    () => {
      removeNavObserver();
    },
    { once: false },
  );
</script>   <main data-astro-cid-4sn4zg3r> <section class="container mt-8 sm:mt-32" data-astro-cid-4sn4zg3r>  <h1 class="primary-color leading-relaxed" data-astro-cid-4sn4zg3r>CSAPP 2e Datalab é¢˜è§£</h1> <p class="mt-4 secondary-color leading-relaxed" data-astro-cid-4sn4zg3r> <i class="ri-calendar-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>2023 å¹´ 03 æœˆ 20 æ—¥</span>   <br data-astro-cid-4sn4zg3r> <i class="ri-discuss-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>å…± 4 æ¡è¯„è®º</span>  </p> <hr class="my-8" data-astro-cid-4sn4zg3r> <p class="card p-2 my-8" data-astro-cid-4sn4zg3r>
âš™ï¸ å…¨æ–°åšå®¢å‰ç«¯ä»åœ¨æµ‹è¯•ä¸­ã€‚å¦‚æœæ–‡ç« æ˜¾ç¤ºä¸æ­£å¸¸ï¼Œå¯ä»¥å°è¯•è®¿é—®<a href="https://blog.skywt.cn/posts/csapp-2e-datalab" class="link underline" data-astro-cid-4sn4zg3r>åŸåšå®¢çš„è¿™ç¯‡æ–‡ç« </a>ã€‚
</p> <article class="content" data-astro-cid-4sn4zg3r> <p>CSAPP æ˜¯ CMU äº«èª‰å…¨çƒçš„è¯¾ç¨‹ï¼Œå°¤å…¶ä»¥å…¶ lab éš¾åº¦ä¹‹é«˜è‘—ç§°ã€‚è¿™æ˜¯è¯¾ç¨‹çš„ç¬¬ä¸€ä¸ª labï¼šdatalabï¼Œä¸ºäº†è®©æˆ‘ä»¬ç†Ÿç»ƒæŒæ¡è®¡ç®—æœºä¸­çš„æ•°æ®å­˜å‚¨è€Œè®¾è®¡ã€‚</p><!--more--><h2>å‰è¨€ï¼šä»€ä¹ˆæ˜¯ cheating</h2><p>ä¹‹å‰åœ¨ B ç«™ä¸Š CSAPP ç¬¬ä¸€èŠ‚è¯¾ï¼Œæ•™æˆå°±è¯´äº†åœ¨ CMUï¼Œä½œå¼Šçš„å®šä¹‰æ˜¯ä»€ä¹ˆï¼Œè¯´å®è¯æœ‰ç‚¹ shockedï¼š</p><p><img src="https://blog.skywt.cn/usr/uploads/2023/03/708355136.png" alt="Cheating: Description" title="Cheating: Description"></p><p><img src="https://blog.skywt.cn/usr/uploads/2023/03/3491785294.png" alt="Cheating: Consequence" title="Cheating: Consequence"></p><p>CMU CSAPP çš„è§„å®šæ˜¯ï¼Œå®Œæˆ lab çš„æ—¶å€™ä¸å¯ä»¥ä¸Šç½‘æŸ¥èµ„æ–™ï¼Œåªè¦ä¸Šç½‘æœç´¢äº†ï¼Œä¸ç®¡æœ‰æ²¡æœ‰æ‰¾ç»“æœï¼Œæœç´¢çš„è¿™ä¸ªè¿‡ç¨‹å°±ç®—ä½œ cheatingï¼ˆè¿™åªæ˜¯è¯¾ç¨‹å®éªŒï¼ï¼‰ã€‚<br>ä¸€ä¸ªå­¦æœŸæœ‰ 25 äººå› ä¸º cheating å—åˆ°æƒ©ç½šï¼Œè€Œä¸”åæœååˆ†ä¸¥é‡ã€‚çœ‹çœ‹æˆ‘ä»¬çš„ HNUï¼Œè‡³ä»Šæ²¡å¬è¯´è¿‡æœ‰è°å› ä¸ºä½œå¼Šè€Œå—åˆ°å¤„åˆ†â€¦â€¦</p><p>æŒ‰ç…§è¿™ä¸ªè¦æ±‚ï¼Œlab åšå¾—çœŸçš„éå¸¸ç—›è‹¦ã€‚æœ‰äº›é¢˜ç›®è¦æƒ³å¾ˆä¹…è¿˜æƒ³ä¸å‡ºæ¥ã€‚è€Œä¸”è¯´å®è¯è¿˜æ˜¯æœ‰ä¸€ä¸¤ä¸ªé¢˜ç›®ä¸ä¼šåšï¼Œå»ç½‘ä¸Šçœ‹äº†åˆ«äººçš„ solutionã€‚ä½†æ˜¯è¿™æ ·åšå®Œçš„ datalabï¼Œç›¸æ¯”ç›´æ¥ä¸Šç½‘ä¸€é€šæœç´¢æŠ„æ¥çš„ä»£ç ï¼Œç¡®å®æ›´åŠ æœ‰æˆå°±æ„Ÿï¼Œä¹Ÿå¯¹è‡ªå·±çš„ã€ŒäºŒè¿›åˆ¶æ€ç»´ã€èƒ½åŠ›æœ‰æ›´å¤§çš„é”»ç‚¼ã€‚è¿™ä¹Ÿæ­£æ˜¯è¿™å‡ ä¸ª lab çš„æ„ä¹‰æ‰€åœ¨å§ã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœä½ åœ¨åš datalab è€Œä¸Šç½‘æœç´¢çœ‹åˆ°äº†è¿™é‡Œï¼Œåœ¨ç»§ç»­çœ‹ä¸‹å»ä¹‹å‰ï¼Œä¸å¦¨å†ç»§ç»­ç‹¬ç«‹æ€è€ƒä¸€ä¸‹å§ã€‚</p><h2>æœ¬å®éªŒçš„ä¸€äº›å‘</h2><ul><li><code>dlc</code> è¿™ä¸ªè¯­æ³•æ£€æŸ¥å™¨æŒ‰ç…§ C89/C90ï¼ˆANSI Cï¼‰çš„æ ‡å‡†ï¼Œè¿™ä¸ªæ ‡å‡†è§„å®š<strong>æ‰€æœ‰å±€éƒ¨å˜é‡éƒ½è¦åœ¨ä»£ç å—çš„å¼€å¤´å®šä¹‰</strong>ã€‚æ‰€ä»¥å¦‚æœåœ¨å‡½æ•°ä¸­é€”å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œè™½ç„¶ç”¨ <code>make</code> å¯ä»¥æ­£å¸¸ç¼–è¯‘ï¼ˆç°åœ¨çš„ç¼–è¯‘å™¨å¾ˆå°‘è¿˜ç”¨ ANSI C æ ‡å‡†ï¼‰ï¼Œä½†æ˜¯ç”¨ <code>dlc</code> æ£€æŸ¥åˆ™ä¼šæç¤º <code>parse error</code> çš„é”™è¯¯ã€‚</li><li>å®éªŒç¯å¢ƒå¿…é¡»æ˜¯æ—§ç‰ˆæœ¬çš„ Linux ç¯å¢ƒï¼ˆå¦‚ Ubuntu 12.04 LTSï¼‰ã€‚ä½¿ç”¨è¾ƒæ–°çš„å‘è¡Œç‰ˆå¯èƒ½ä¼šå¯¼è‡´æ— æ³•é€šè¿‡ fitsBits è¿™ä¸€å…³ã€‚ï¼ˆç›®å‰æš‚ä¸æ¸…æ¥šæ˜¯ç¼–è¯‘å™¨è¿˜æ˜¯å†…æ ¸ç­‰çš„é—®é¢˜ï¼Œæ®è¯´æ˜¯æœ¬ lab æœ¬èº«çš„ä¸€ä¸ª bugï¼‰</li></ul><h2>ç”¨ docker åˆ›å»ºè¿è¡Œç¯å¢ƒ</h2><p>åœ¨ x86 çš„ä¸»æœºä¸Šä½¿ç”¨ docker åˆ›å»º Ubuntu 12.04 LTS çš„å®¹å™¨ï¼ŒæŒ‡å®šå°†å®¹å™¨å†… <code>/home</code> ç›®å½•æ˜ å°„åˆ°å®¹å™¨å¤–çš„ç›®å½•ï¼Œç„¶åè¿›å…¥å®¹å™¨ï¼Œå®‰è£…ç›¸å…³è½¯ä»¶ï¼š</p><pre><code class="lang-bash"># å°†å®¹å™¨å†… /home æ˜ å°„åˆ°å®¹å™¨å¤– /root/Lab/HNU-CSAPP/ex2/docker-env/homeï¼Œè¿™ä¸¤ä¸ªç›®å½•ä¹Ÿå¯ä»¥è‡ªå·±æŒ‡å®š
docker run -itd --name datalab -v /root/Lab/HNU-CSAPP/ex2/docker-env/home:/home ubuntu:12.04
# è¿›å…¥å®¹å™¨å†…çš„ shell
docker exec -it datalab /bin/bash
# 12.04 å¹´ä»£ä¹…è¿œï¼Œéœ€è¦å°† sources é‡Œ archive.ubuntu.com æ”¹ä¸º old-reloease.ubuntu.com æ‰èƒ½ apt-get update
sed -i -e 's/archive.ubuntu.com\|security.ubuntu.com/old-releases.ubuntu.com/g' /etc/apt/sources.list
# è·å–è½¯ä»¶åŒ…åˆ—è¡¨
apt-get update
# å®‰è£…æœ¬å®éªŒå¿…è¦çš„è½¯ä»¶åŒ…
apt-get install gcc make gcc-multilib</code></pre><p>å›åˆ°å®¹å™¨å¤–ï¼Œå°†æ–‡ä»¶ç§»è¿›æŒ‡å®šçš„ç›®å½•ï¼ˆ<code>/root/Lab/HNU-CSAPP/ex2/docker-env/home</code>ï¼‰ï¼Œç¼–è¾‘å¥½åå†è¿›å…¥å®¹å™¨æµ‹è¯•ã€‚<br>å¯ä»¥ç”¨ tmux åŠå±å¼€ vim å†™ä»£ç ï¼ŒåŠå±è¿›å®¹å™¨ç»ˆç«¯æµ‹è¯•ã€‚</p><p>æ³¨æ„å¦‚æœåœ¨å®¹å™¨å¤–æµ‹è¯•è¿‡äº†ï¼Œè¿›å…¥å®¹å™¨è¦ <code>make clean</code> å†é‡æ–° <code>make</code>ï¼Œå› ä¸ºä¸åŒç¯å¢ƒç¼–è¯‘ç”Ÿæˆçš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶å¯èƒ½ä¸å…¼å®¹ã€‚</p><h2>bitAnd</h2><p>ç”¨æˆ–å’Œéå®ç°ä¸ï¼Œç”¨ç›´æ¥å–åçš„æ–¹æ³•å³å¯ï¼šx and y = not ((not x) or (not y))ã€‚</p><h2>getByte</h2><p>å¾ˆæ˜¾ç„¶ç­”æ¡ˆæ˜¯ <code>(x &gt;&gt; n*8) &amp; 0xFF</code>ã€‚ä½†æ˜¯ä¸å…è®¸ä½¿ç”¨ä¹˜æ³•ï¼Œå¦‚ä½•è·å¾— <code>n*8</code> å‘¢ï¼Ÿ<br>ç­”æ¡ˆæ˜¯ç›´æ¥ç”¨åŠ æ³•ã€‚8 ä¸ª n ç›¸åŠ ä¼šè¶…è¿‡ ops æ•°é‡é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆåŠ å‡º 2nã€4nã€‚</p><h2>logicalShift</h2><p>è¦æ±‚å®ç° logical shiftï¼Œå› ä¸ºé»˜è®¤çš„ shift æ˜¯ arithmetic shiftã€‚æœ¬è´¨çš„åŒºåˆ«åœ¨äºè´Ÿæ•°çš„ shrï¼Œå‰è€…å·¦è¾¹å‡ºæ¥çš„æ˜¯ 0 è€Œå³è€…å‡ºæ¥çš„æ˜¯ 1ã€‚</p><p>å¾ˆå®¹æ˜“æƒ³åˆ°å¯ä»¥ and ä¸Šä¸€ä¸ª keeperï¼Œè¿™ä¸ª keeper çš„å€¼æ˜¯ <code>0000111...11</code>ï¼Œå³è¾¹çš„ 1 å°±æ˜¯è¦ä¿ç•™çš„é‚£äº›ä½ã€‚è¿™æ ·å¯ä»¥å»æ‰å·¦è¾¹äº§ç”Ÿçš„ 1ã€‚<br>å¦‚ä½•å¾—åˆ°è¿™ä¸ª keeperï¼Ÿæ˜¾ç„¶ keeper = <code>0x7FFFFFFF</code> &gt;&gt; (n-1)ã€‚</p><p>æœ‰ä¸¤ä¸ªé—®é¢˜ã€‚é¦–å…ˆæ˜¯å¦‚ä½•äº§ç”Ÿ <code>0x7FFFFFFF</code> è¿™ä¸ªæ•°å­—å‘¢ï¼Ÿå› ä¸ºæ¸¸æˆè§„åˆ™è§„å®šç«‹å³æ•°èµ‹å€¼ä¸èƒ½è¶…è¿‡ 2 Byteã€‚ç­”æ¡ˆæ˜¯ <code>~(1 &lt;&lt; 31)</code>ã€‚</p><p>æ¥ä¸‹æ¥æ˜¯å¦‚ä½•å¤„ç† n = 0 çš„æƒ…å†µã€‚å¥½åœ¨è¿™å…³å…è®¸æˆ‘ä»¬ç”¨ <code>!</code> è¿ç®—ç¬¦ï¼Œå¯ä»¥å®ç°ç±»ä¼¼é€‰æ‹©èµ‹å€¼çš„è¯­å¥ã€‚<br>å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦è¿™æ ·ä¸€ä¸ª flag å˜é‡ï¼Œå½“ n ä¸º 0 æ—¶å®ƒæ˜¯ <code>0x00000000</code>ï¼Œå½“ n é 0 æ—¶å®ƒæ˜¯ <code>0xFFFFFFFF</code>ã€‚<br>è¯•è¯•ç”¨ <code>!</code> è¿ç®—ç¬¦ï¼Œç›´æ¥å¯¹ n å–é€»è¾‘é notnï¼Œè¿™æ · n ä¸º 0 æ—¶æˆ‘ä»¬å¾—åˆ° 1ï¼Œn é 0 æ—¶æˆ‘ä»¬å¾—åˆ° 0ã€‚<br>å¾ˆæ˜¾ç„¶ï¼Œflag = notn - 1ã€‚<br>ç°åœ¨æˆ‘ä»¬åˆ†åˆ«è®¡ç®—å‡º n ä¸º 0 å’Œä¸ä¸º 0 çš„ä¸¤ç§æƒ…å†µ result1 å’Œ result2ï¼Œåˆ™æœ€ååªéœ€è¦è¿”å› <code>((!flag) &amp; result1) | (flag &amp; result2)</code>ã€‚æ˜¯ä¸æ˜¯æœ‰ç‚¹åƒæ•°ç”µé‡Œçš„ã€Œå¤šè·¯å¤ç”¨ã€å‘¢ã€‚<br><strong>è¿™ç§å¯¹ n = 0 ç‰¹åˆ¤çš„æ–¹æ³•ï¼Œåœ¨åé¢çš„å…³å¡ä¸­ä¼šå¤šæ¬¡é‡åˆ°ã€‚</strong></p><p>æœ€åï¼Œè¿™å…³ä¸èƒ½ç”¨ <code>-</code> å‡æ³•ï¼Œå¦‚ä½•å®ç° -1 å‘¢ï¼Ÿç›´æ¥ç”¨åŠ ä¸Š <code>0xFFFFFFFF</code> å°±è¡Œå•¦ã€‚</p><h2>bitCount</h2><p>ï¼ˆè¿™é¢˜æœ‰ç‚¹éš¾æƒ³ ğŸ˜¨ï¼‰</p><p>è¦æ±‚ç»Ÿè®¡äºŒè¿›åˆ¶ä¸­ 1 çš„ä¸ªæ•°ï¼ˆå°±æ˜¯ popcountï¼‰ã€‚å…¶å®å¯¹äºæ¯ä¸€ä½æ˜¯ 0 æ˜¯ 1 æˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡ and å¾—çŸ¥ï¼Œæœ€éš¾çš„å°±æ˜¯å¦‚ä½•ç´¯åŠ ã€‚<br>ç´¯åŠ çš„éƒ¨åˆ†å¯ä»¥è€ƒè™‘åˆ†æ²»ï¼Œè¦ç´¯åŠ  32 ä½çš„ç»“æœï¼Œæˆ‘ä»¬å‡è®¾å¾—åˆ°äº†ä¸¤ä¸ª 16 ä½çš„ç»“æœï¼Œåªè€ƒè™‘è¿™ä¸¤ä¸ªå¦‚ä½•ç›¸åŠ ï¼›è¦è®¡ç®— 16 ä½çš„ç»“æœåªè€ƒè™‘ä¸¤ä¸ª 8 ä½çš„ç»“æœå¦‚ä½•ç›¸åŠ ï¼Œä»¥æ­¤ç±»æ¨ã€‚<br>é‚£ä¹ˆä¸¤ä¸ª 16 ä½çš„ç»“æœå¦‚ä½•ç›¸åŠ å‘¢ï¼Ÿæˆ‘ä»¬å‡è®¾ä¸¤ä¸ªç»“æœåˆ†åˆ«å­˜å‚¨åœ¨ 32 ä½ int çš„é«˜ 16 ä½å’Œä½ 16 ä½ï¼Œåªè¦æŠŠä¸¤ä¸ªéƒ¨åˆ†å–å‡ºæ¥ï¼Œå‰è€…å³ç§» 16 ä½ç›¸åŠ å³å¯ã€‚ä¸‹é¢çš„ä¹Ÿç±»ä¼¼ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œé¢˜ç›®è¦æ±‚ä½¿ç”¨çš„ç«‹å³æ•°å¤§å°ä¸è¶…è¿‡ 0xFFï¼Œéœ€è¦ç”¨ä¸€äº› tricky çš„æ‰‹æ®µè·å¾—æˆ‘ä»¬è¦çš„ç«‹å³æ•°ï¼Œä»¥å…è¶…å‡ºç¬¦å·æ•°é‡é™åˆ¶ã€‚å¯ä»¥å‚é˜…ä»£ç ã€‚</p><h2>bang</h2><p>è¦æ±‚è®¡ç®—é€»è¾‘åï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦è¿”å›è¿™æ ·ä¸€ä¸ªå€¼ï¼Œå½“ x ä¸ºå…¨ 0 æ—¶å…¶ä¸º 1ï¼Œx ä»»ä½•ä¸€ä½ä¸º 1 æ—¶å…¶ä¸º 0ã€‚<br>ç†æ‰€å½“ç„¶åœ°å¯ä»¥æƒ³åˆ°åº”è¯¥æŠŠ x æ¯ä¸€ä½ or èµ·æ¥ï¼ˆæˆ–è€…æŠŠ ~x æ¯ä¸€ä½ and èµ·æ¥ï¼‰ï¼Œç»“æœæ”¾åœ¨æœ€ä½ä½ï¼Œå¾—åˆ° 1 æˆ– 0ã€‚<br>ç„¶è€Œå¦‚æœçœŸçš„å–å‡º 32 ä½æ¯ä¸€ä½è¿›è¡Œ orï¼Œops ä¼šè¶…è¿‡é™åˆ¶ã€‚å¯ä»¥ç”¨åˆ†æ²»çš„æ–¹æ³•ï¼Œå…ˆå°† [0,15] å’Œ [16,31] è¿™ä¸¤æ®µæŒ‰ä½å¤„ç†æ”¾å…¥ä½çš„ä¸€æ®µï¼Œå†å¤„ç† [0,7] å’Œ [8,15]ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå¯ä»¥åœ¨ ops æ•°é‡é™åˆ¶å†…å®Œæˆã€‚</p><h2>tmin</h2><p>è¿”å›æœ€å°çš„ intï¼Œå°±æ˜¯ 1 &lt;&lt; 31ã€‚</p><h2>fitsBits</h2><p>ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ä¸€å¼€å§‹æƒ³çš„å¥‡æ€ªæ–¹æ³•ï¼Œè‡³å°‘éœ€è¦ç”¨åˆ° 19 ä¸ª opsï¼Œè¶…è¿‡é¢˜ç›®é™åˆ¶ï¼Œå…¶å®ä¸èƒ½é€šè¿‡ã€‚</p><p>è¦æˆ‘ä»¬è¿”å› 0 æˆ– 1 è¡¨ç¤º x æ˜¯å¦èƒ½è¢« n ä½è¡¥ç è¡¨ç¤ºï¼Œå®é™…ä¸Šå°±æ˜¯è¿”å›æ˜¯å¦ $-2^{n-1} \le x \le 2^{n-1}-1$ã€‚<br>ä¹Ÿå°±æ˜¯ $-2^{n-1} \le x \lt 0$ æˆ– $0 \le x \le 2^{n-1}-1$ã€‚<br>å†å˜æ¢ä¸€ä¸‹ï¼Œå°±æ˜¯ï¼š$0 \le x+2^{n-1} &lt; 2^{n-1}$ æˆ– $-2^{n-1} \le x-2^{n-1} \le -1$ã€‚<br>ä¹Ÿå°±æ˜¯å¦‚æœ $x &lt; 0$ åˆ™è¦æ»¡è¶³ $x+2^{n-1} \ge 0$ï¼›å¦‚æœ $x \ge 0$ åˆ™è¦æ»¡è¶³ $x-2^{n-1} \le -1$ã€‚ä¾ç„¶æ ¹æ® x çš„ç¬¦å·ä½é€‰æ‹©ä¸€ä¸ªç»“æœè¿”å›ã€‚</p><p>ç¬¬äºŒç§æ–¹æ³•åˆ™æ˜¯å¯ä»¥é€šè¿‡çš„æ­£è§£ï¼š</p><p>æ ¹æ®ç®—æ•°ç§»ä½çš„æ€§è´¨ã€‚å‡è®¾ç»™æˆ‘ä»¬ä¸€ä¸ª n ä½è¡¥ç è¡¨ç¤ºçš„æ•°ï¼Œæˆ‘ä»¬ç›´æ¥å°†å…¶å·¦ç§»è‡³ä¸ 32 ä½ int ç¬¦å·ä½å¯¹é½ï¼Œç„¶åå†ç§»å›å»ï¼Œå¾—åˆ°çš„ç»“æœåº”è¯¥æ˜¯å’ŒåŸæ¥ä¸€æ ·çš„ã€‚æ®æ­¤å³å¯åˆ¤æ–­ã€‚</p><p><strong>âš ï¸ è¿™é¢˜ä½¿ç”¨è¾ƒæ–°ç‰ˆæœ¬çš„ç¯å¢ƒæµ‹è¯•æ˜¯æ— æ³•é€šè¿‡çš„</strong>ï¼Œç›®å‰æš‚ä¸æ¸…æ¥šä¸ä»€ä¹ˆå› ç´ æœ‰å…³ã€‚åœ¨ Ubuntu 12.04 LTS x86_64 ä¸­æµ‹è¯•å¯ä»¥é€šè¿‡ã€‚è¯¦è§å¼€å¤´ã€Œç”¨ docker åˆ›å»ºè¿è¡Œç¯å¢ƒã€ã€‚</p><h2>divpwr2</h2><p>è¦æ±‚è¿”å› $\frac{x}{2^n}$ï¼Œå‘ 0 å–æ•´ã€‚<br>å¯¹äºæ­£æ•°å½“ç„¶å°±æ˜¯ &gt;&gt; n å³å¯ï¼Œå¯¹äºè´Ÿæ•°å°±æœ‰äº›å¤æ‚ï¼Œå› ä¸º &gt;&gt; è¿ç®—é»˜è®¤å‘ä¸‹å–æ•´ï¼Œéœ€è¦è¿›è¡Œä¿®æ­£ã€‚<br>å¯¹äºè´Ÿæ•°ï¼Œåˆ—è¡¨å¯ä»¥å‘ç°ï¼Œæ¯ä¸ªæ•°å­—åœ¨è®¡ç®—ä¹‹å‰è¦åŠ ä¸Š $2^n-1$ çš„åç§»æ‰èƒ½å¾—åˆ°æ­£ç¡®ç­”æ¡ˆã€‚<br>å› ä¸ºå‡ºç°äº† n - 1ï¼Œæ‰€ä»¥è¿˜è¦ç‰¹åˆ«è€ƒè™‘ n = 0 çš„æƒ…å†µã€‚ä½¿ç”¨ logicalShift ä¸€æ ·çš„ã€Œå¤šè·¯å¤ç”¨ã€æ–¹æ³•å³å¯ã€‚</p><h2>negate</h2><p>å–è´Ÿæ•°ï¼Œå°±æ˜¯ (~x)+1ï¼Œå¾ˆç®€å•ã€‚</p><h2>isPositive</h2><p>æ ¹æ®ç¬¦å·ä½ï¼Œå¯ä»¥è½»æ˜“åˆ¤æ–­å‡ºè¿™ä¸ªæ•°æ˜¯å¦ &gt;= 0ã€‚æ—¢ç„¶æœ¬é¢˜è¦æ±‚åˆ¤æ–­ &gt; 0ï¼Œä¹Ÿå°±æ˜¯ 0 æ˜¯ç‰¹æ®Šæƒ…å†µï¼Œä¾ç„¶å¯ä»¥æ ¹æ®å‰é¢çš„æ–¹æ³•ç‰¹æ®Šåˆ¤æ–­ã€‚</p><h2>isLessOrEqual</h2><p>åˆ¤æ–­ $x \le y$ï¼Œä¸èƒ½ç›´æ¥åˆ¤æ–­ $y-x \ge 0$ï¼Œå› ä¸ºä¼š overflowã€‚<br>å¯ä»¥å‘ç°å¦‚æœ x å’Œ y åŒå·ï¼Œè‚¯å®šä¸ä¼š overflowã€‚æ‰€ä»¥åªéœ€è¦å¯¹å¼‚å·çš„æƒ…å†µè¿›è¡Œåˆ¤æ–­ã€‚<br>ä¸ºäº†æ›´åŠ æ¸…æ™°ï¼Œåˆ—å‡ºä¸€ä¸ªçœŸå€¼è¡¨ï¼š</p><table><thead><tr><th>x ç¬¦å·ä½</th><th>y ç¬¦å·ä½</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td>1</td><td>0</td><td>1</td></tr><tr><td>0</td><td>1</td><td>0</td></tr><tr><td>0</td><td>0</td><td>y-x çš„ç¬¦å·ä½å–å</td></tr><tr><td>1</td><td>1</td><td>y-x çš„ç¬¦å·ä½å–å</td></tr></tbody></table><p>ä¾ç„¶æ˜¯ä¸ªåˆ†ç±»è®¨è®ºï¼ˆã€Œå¤šè·¯å¤ç”¨ã€ï¼‰çš„æ€è·¯ï¼Œæ ¹æ® x xor y çš„å€¼è¿”å›ç­”æ¡ˆï¼Œå¦‚æœä¸º 1 ç­”æ¡ˆæ˜¯ x çš„ç¬¦å·ä½ï¼Œå¦‚æœä¸º 0 ç­”æ¡ˆä¸º y-x çš„ç¬¦å·ä½å–åã€‚</p><h2>ilog2</h2><p>è¦æ±‚è¿”å› log2(x) å‘ä¸‹å–æ•´ã€‚å¾ˆæ˜¾ç„¶ç­”æ¡ˆå°±æ˜¯ x çš„äºŒè¿›åˆ¶ä¸­æœ€å·¦è¾¹çš„ 1ï¼ˆæœ€é«˜ä½ï¼‰åœ¨ä»å³å¾€å·¦ç¬¬å‡ ä½ã€‚<br>é¦–å…ˆé€šè¿‡å°† x æŒ‰ä½æˆ– x &gt;&gt; k çš„æ‰‹æ®µï¼ˆk åˆ†åˆ«ç­‰äº 1ã€2ã€4â€¦â€¦ï¼‰ï¼Œå¯ä»¥å°† x = 0001xxxxx å˜ä¸º x = 000111111ï¼Œä¹Ÿå°±æ˜¯æœ€é«˜ä½ä¹‹åå…¨éƒ½å˜æˆ 1ã€‚ç„¶åå¯ä»¥åšä¸€éä¹‹å‰çš„ bitCountï¼Œå°†ç»“æœå‡å» 1 å³å¯ã€‚</p><h2>float_neg</h2><p>è¿™éƒ¨åˆ†ç»ˆäºå¯ä»¥ç”¨ if äº†ã€‚åªè¦åˆ¤æ–­ NaN çš„æƒ…å†µåŸå°ä¸åŠ¨è¿”å›ï¼Œå¦åˆ™ä¿®æ”¹ç¬¦å·ä½è¿”å›å°±è¡Œã€‚<br>å¯¹ç¬¦å·ä½å–åå¯ä»¥å¯¹ <code>1&lt;&lt;31</code> å–å¼‚æˆ–ã€‚<br>å¯ä»¥æ„é€ ä¸¤ä¸ªå˜é‡ get_exp å’Œ get_frac åˆ†åˆ«ç”¨äºå’Œä¸€ä¸ªæ•°æŒ‰ä½ä¸ï¼Œä»è€Œå–å‡ºè¿™ä¸ªæ•°ä¸­çš„ exp æˆ– frac ç‰‡æ®µã€‚exp å°±æ˜¯ <code>0xFF</code> &lt;&lt; 23ï¼Œfrac åˆ™æ˜¯ ~exp å†å¯¹ç¬¦å·ä½å–åã€‚</p><h2>float_i2f</h2><p>è¦å°†æä¾›çš„ int å€¼ x è½¬æ¢ä¸º floatã€‚<br>int å’Œ float å…³äºè´Ÿæ•°çš„æ¦‚å¿µæ˜¯æˆªç„¶ä¸åŒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»å¯¹ int çš„ç»å¯¹å€¼è¿›è¡Œå¤„ç†ã€‚æ‰€ä»¥é¦–å…ˆè¦å¯¹äº x &lt; 0 çš„æƒ…å†µè®¾ç½®ç¬¦å·ä½åç›´æ¥å–ç›¸åæ•°ã€‚ï¼ˆæ­¤æ—¶æ³¨æ„ç‰¹åˆ¤ tmin çš„æƒ…å†µï¼å®ƒæ²¡æœ‰èƒ½ç”± int è¡¨ç¤ºçš„ç›¸åæ•°ï¼‰è®¾ç½®å¥½ sign åï¼Œåªè¦å¤„ç† exp å’Œ frac å³å¯ã€‚<br>å‡è®¾ x æ˜¯ä¸ª n ä½çš„äºŒè¿›åˆ¶æ•°ï¼Œexp å°±ç­‰äº n - 1 + biasã€‚<br>frac å°±æ˜¯å³è¾¹çš„ n - 1 ä½ï¼ˆå·¦å¯¹é½ï¼‰ã€‚è¦è€ƒè™‘è¿›ä½é—®é¢˜ã€‚å°† frac è¢«æˆªæ‰çš„éƒ¨åˆ†æ‹¿å‡ºæ¥ï¼ˆæœ€å¤šæœ‰ 8 ä½ï¼‰ï¼Œå¦‚æœã€Œå¤§äº 0x80ã€æˆ–è€…ã€Œç­‰äº 0x80 ä¸”frac æœ«ä½ä¸º 1ã€ï¼ˆround to even çš„æƒ…å†µï¼‰åˆ™è¦è¿›ä¸€ä½ï¼Œfrac è¿ç»­è¿›ä½ã€‚æ³¨æ„åˆ° frac æœ‰å¯èƒ½è¿›ä½è¿›åˆ° exp é‡Œï¼Œä½†æ˜¯æˆ‘ä»¬çš„ä»£ç é‡Œä¸ç”¨åˆ¤æ–­ï¼Œå› ä¸º frac æœ€é«˜ä½ä¹‹å‰å°±æ˜¯ exp æœ€ä½ä½ã€‚ï¼ˆåœ¨è¿™é‡Œæ˜¯ä¸æ˜¯å†æ¬¡æ„Ÿåˆ°äº† IEEE æµ®ç‚¹æ•°è®¾è®¡çš„ç²¾å¦™ï¼Ÿï¼‰<br>æœ€åæ³¨æ„è¿™é¢˜ 0 ä¹Ÿè¦ç‰¹åˆ¤ï¼Œå› ä¸º 0 å±äº denomilizedã€‚</p><p>è¿™é¢˜å†™èµ·æ¥å¾ˆå®¹æ˜“è¶…è¿‡ ops æ•°é‡é™åˆ¶ã€‚éœ€è¦çœç€ç‚¹ç”¨ã€‚</p><h2>float_twice</h2><p>å°†ç»™å‡ºçš„ float ç¿»ä¸¤å€ï¼Œè¦åˆ†åˆ«è€ƒè™‘ nomalizedã€denomolized å’Œ special çš„æƒ…å†µã€‚<br>nomolized å¾ˆç®€å•ï¼Œç›´æ¥ä¿®æ”¹ exp éƒ¨åˆ†å³å¯ã€‚æ³¨æ„å¯èƒ½æœ‰ nomolized è¿›å…¥ infinity çš„æƒ…å†µã€‚<br>denomolized åªéœ€è¦ä¿®æ”¹ frac å³å¯ã€‚æ³¨æ„å¯èƒ½æœ‰ä» denomolized è¿›å…¥ nomolized çš„æƒ…å†µï¼Œè¦ä¿®æ”¹ expã€‚<br>æœ€å infinityã€NaN è¿™ä¸¤ç§å€¼éƒ½åŸæ ·è¿”å›ï¼Œéœ€è¦ç‰¹åˆ¤ã€‚</p><h2>å®Œæ•´ä»£ç å‚è€ƒ</h2><pre><code class="lang-cpp">/* 
 * bitAnd - x&amp;y using only ~ and | 
 *   Example: bitAnd(6, 5) = 4
 *   Legal ops: ~ |
 *   Max ops: 8
 *   Rating: 1
 */
int bitAnd(int x, int y) {
  return ~((~x) | (~y));
}
/* 
 * getByte - Extract byte n from word x
 *   Bytes numbered from 0 (LSB) to 3 (MSB)
 *   Examples: getByte(0x12345678,1) = 0x56
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 6
 *   Rating: 2
 */
int getByte(int x, int n) {
  int n2 = n + n;
  int n4 = n2 + n2;
  int n8 = n4 + n4;
  return (x &gt;&gt; n8) &amp; 0xFF;
}
/* 
 * logicalShift - shift x to the right by n, using a logical shift
 *   Can assume that 0 &lt;= n &lt;= 31
 *   Examples: logicalShift(0x87654321,4) = 0x08765432
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 20
 *   Rating: 3 
 */
int logicalShift(int x, int n) {
  int sub1 = ~0;
  int keeper = ~(1 &lt;&lt; 31);
  int result = (x &gt;&gt; n) &amp; (keeper &gt;&gt; (n + sub1));
  int notn = !n;
  int flag = notn + sub1;
 return ((~flag) &amp; x) | (flag &amp; result);
}
/*
 * bitCount - returns count of number of 1's in word
 *   Examples: bitCount(5) = 2, bitCount(7) = 3
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 40
 *   Rating: 4
 */
int bitCount(int x) {
  int ret = x;
  int mask = 0;
  // 0x55555555
  mask = 0x55 + (0x55 &lt;&lt; 8);
  mask = mask + (mask &lt;&lt; 16);
  ret = (ret &amp; mask) + ((ret&gt;&gt;1) &amp; mask);
  // 0x33333333
  mask = 0x33 + (0x33 &lt;&lt; 8);
  mask = mask + (mask &lt;&lt; 16);
  ret = (ret &amp; mask) + ((ret&gt;&gt;2) &amp; mask);
  // 0x0f0f0f0f
  mask = 0x0f + (0x0f &lt;&lt; 8) + (0x0f &lt;&lt; 16) + (0x0f &lt;&lt; 24);
  ret = (ret &amp; mask) + ((ret&gt;&gt;4) &amp; mask);
  // 0x00ff00ff
  mask = 0xff + (0xff &lt;&lt; 16);
  ret = (ret &amp; mask) + ((ret&gt;&gt;8) &amp; mask);
  // 0x0000ffff
  mask = 0xff + (0xff &lt;&lt; 8);
  ret = (ret &amp; mask) + ((ret&gt;&gt;16) &amp; mask);
  return ret;
}
/* 
 * bang - Compute !x without using !
 *   Examples: bang(3) = 0, bang(0) = 1
 *   Legal ops: ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 12
 *   Rating: 4 
 */
int bang(int x) {
  int ret = ~x;
  ret = ret &amp; (ret &gt;&gt; 16);
  ret = ret &amp; (ret &gt;&gt; 8);
  ret = ret &amp; (ret &gt;&gt; 4);
  ret = ret &amp; (ret &gt;&gt; 2);
  ret = ret &amp; (ret &gt;&gt; 1);
  return ret&amp;1;
}
/* 
 * tmin - return minimum two's complement integer 
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 4
 *   Rating: 1
 */
int tmin(void) {
  return 1 &lt;&lt; 31;
}
/* 
 * fitsBits - return 1 if x can be represented as an 
 *  n-bit, two's complement integer.
 *   1 &lt;= n &lt;= 32
 *   Examples: fitsBits(5,3) = 0, fitsBits(-4,3) = 1
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 15
 *   Rating: 2
 */
int fitsBits(int x, int n) {
//  int sub1 = ~0;
//  int get_sign = 1&lt;&lt;31;
//  int sign = x &amp; get_sign;
//  int not_sign = !sign;
//  int power = 1 &lt;&lt; (n + sub1);
//  int sub_power = (~power) + 1;
//  int result1 = !(((x + power) &amp; get_sign) &gt;&gt; 31);
//  int result2 = ((x + sub_power) &amp; get_sign) &gt;&gt; 31;
//  sign = !not_sign;
//  return (sign &amp; result1) | (not_sign &amp; result2);
  int subn = (~n) + 1;
  int to_shl = 32 + subn;
  int x_fix = (x &lt;&lt; to_shl) &gt;&gt; to_shl;
  int not_ans = x ^ x_fix;
  return !not_ans;
}
/* 
 * divpwr2 - Compute x/(2^n), for 0 &lt;= n &lt;= 30
 *  Round toward zero
 *   Examples: divpwr2(15,1) = 7, divpwr2(-33,4) = -2
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 15
 *   Rating: 2
 */
int divpwr2(int x, int n) {
    // Round to zero is the difficult part
    int sub1 = ~0;
    int super2sub1 = (1&lt;&lt;n) + sub1;
    int notn = !n;
    int flag = notn + sub1;
    int result = (x + ((x &gt;&gt; 31) &amp; super2sub1)) &gt;&gt; n;
    return ((~flag) &amp; x) | (flag &amp; result);
}
/* 
 * negate - return -x 
 *   Example: negate(1) = -1.
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 5
 *   Rating: 2
 */
int negate(int x) {
  return (~x) + 1;
}
/* 
 * isPositive - return 1 if x &gt; 0, return 0 otherwise 
 *   Example: isPositive(-1) = 0.
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 8
 *   Rating: 3
 */
int isPositive(int x) {
  int sub1 = ~0;
  int notx = !x;
  int flag = notx + sub1;
  int result = !(x &gt;&gt; 31);
  return flag &amp; result;
  // return ((~flag) &amp; 0) | (flag &amp; result);
  // the first part isn't necessary
}
/* 
 * isLessOrEqual - if x &lt;= y  then return 1, else return 0 
 *   Example: isLessOrEqual(4,5) = 1.
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 24
 *   Rating: 3
 */
int isLessOrEqual(int x, int y) {
  int xxory = (x &gt;&gt; 31) ^ (y &gt;&gt; 31);
  int subx = (~x) + 1;
  int ysubx = y + subx;
  int result_1 = (x &gt;&gt; 31) &amp; 1;
  int result_2 = !(ysubx &gt;&gt; 31);
  return (xxory &amp; result_1) | ((~xxory) &amp; result_2);
}
/*
 * ilog2 - return floor(log base 2 of x), where x &gt; 0
 *   Example: ilog2(16) = 4
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 90
 *   Rating: 4
 */
int ilog2(int x) {
  int sub1 = ~0;
  int x_fill = x;
  int ret, mask;
  x_fill |= x_fill &gt;&gt; 1;
  x_fill |= x_fill &gt;&gt; 2;
  x_fill |= x_fill &gt;&gt; 4;
  x_fill |= x_fill &gt;&gt; 8;
  x_fill |= x_fill &gt;&gt; 16;

  // perform bitCount
  ret = x_fill;
  mask = 0;
  // 0x55555555
  mask = 0x55 + (0x55 &lt;&lt; 8);
  mask = mask + (mask &lt;&lt; 16);
  ret = (ret &amp; mask) + ((ret&gt;&gt;1) &amp; mask);
  // 0x33333333
  mask = 0x33 + (0x33 &lt;&lt; 8);
  mask = mask + (mask &lt;&lt; 16);
  ret = (ret &amp; mask) + ((ret&gt;&gt;2) &amp; mask);
  // 0x0f0f0f0f
  mask = 0x0f + (0x0f &lt;&lt; 8) + (0x0f &lt;&lt; 16) + (0x0f &lt;&lt; 24);
  ret = (ret &amp; mask) + ((ret&gt;&gt;4) &amp; mask);
  // 0x00ff00ff
  mask = 0xff + (0xff &lt;&lt; 16);
  ret = (ret &amp; mask) + ((ret&gt;&gt;8) &amp; mask);
  // 0x0000ffff
  mask = 0xff + (0xff &lt;&lt; 8);
  ret = (ret &amp; mask) + ((ret&gt;&gt;16) &amp; mask);
  return ret + sub1;
}
/* 
 * float_neg - Return bit-level equivalent of expression -f for
 *   floating point argument f.
 *   Both the argument and result are passed as unsigned int's, but
 *   they are to be interpreted as the bit-level representations of
 *   single-precision floating point values.
 *   When argument is NaN, return argument.
 *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while
 *   Max ops: 10
 *   Rating: 2
 */
unsigned float_neg(unsigned uf) {
  unsigned change_sign = 1 &lt;&lt; 31;
  unsigned get_exp = 0xFF &lt;&lt; 23;
  unsigned get_frac = (~get_exp) ^ change_sign;
  if ((uf &amp; get_exp) == get_exp &amp;&amp; (uf &amp; get_frac) != 0) return uf;
  return uf ^ change_sign;
}
/* 
 * float_i2f - Return bit-level equivalent of expression (float) x
 *   Result is returned as unsigned int, but
 *   it is to be interpreted as the bit-level representation of a
 *   single-precision floating point values.
 *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while
 *   Max ops: 30
 *   Rating: 4
 */
unsigned float_i2f(int x) {
  int bias = 127;
  unsigned get_frac = 0x007fffff;
  unsigned get_frac_cut = 0x000000ff;
  unsigned tminf = 0xcf000000;
  int fix_x, n, nsub1, temp;
  unsigned sign, exp, frac, frac_cut;

  // special cases
  if (x == 0x80000000) return tminf;
  if (x == 0) return 0;

  // get abs / get sign
  fix_x = x;
  sign = 0;
  if (fix_x &lt; 0) fix_x = -fix_x, sign = 0x80000000;

  // get count
  n = 0;
  temp = fix_x;
  while (temp) n++, temp&gt;&gt;=1;
  nsub1 = n - 1;
  //printf(&quot;count=%d\n&quot;,count);

  // get exp
  exp = ((nsub1 + bias) &lt;&lt; 23);

  // get frac
  if (nsub1 &lt;= 23){
    frac = (fix_x &lt;&lt; (23 - nsub1)) &amp; get_frac;
  } else {
    frac = (fix_x &gt;&gt; (nsub1 - 23)) &amp; get_frac;
    frac_cut = (fix_x &lt;&lt; (31 - nsub1)) &amp; get_frac_cut;
    if ((frac_cut &gt; 0x80) || (frac_cut == 0x80 &amp;&amp; (frac &amp; 1))) frac++; // carry
  }

  return sign + exp + frac;
}
/* 
 * float_twice - Return bit-level equivalent of expression 2*f for
 *   floating point argument f.
 *   Both the argument and result are passed as unsigned int's, but
 *   they are to be interpreted as the bit-level representation of
 *   single-precision floating point values.
 *   When argument is NaN, return argument
 *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while
 *   Max ops: 30
 *   Rating: 4
 */
unsigned float_twice(unsigned uf) {
  unsigned neg_inf = 0xff800000;
  unsigned pos_inf = 0x7f800000;
  unsigned get_exp = 0x7f800000;
  unsigned get_frac = 0x007fffff;
  unsigned exp = (uf &amp; get_exp) &gt;&gt; 23;
  unsigned frac = uf &amp; get_frac;
  unsigned ret = uf;
  if (exp == 0xff) return uf;
  if (exp == 0){ // denomolized
    if (frac &amp; (1&lt;&lt;23)){ // de -&gt; no
      ret = ret | (1 &lt;&lt; 23);
      return ret;
    } else {
      ret = ret - frac;
      frac = frac &lt;&lt; 1;
      ret = ret + frac;
      return ret;
    }
  } else { // nomolized
    ret = ret - (exp &lt;&lt; 23);
    exp++;
    if (exp &gt; 0xff) { // no -&gt; inf
      if (uf &amp; (1&lt;&lt;31)) return neg_inf;
      else return pos_inf;
    }
    ret = ret + (exp &lt;&lt; 23);
    return ret;
  }
}</code></pre> </article> <hr class="my-8" data-astro-cid-4sn4zg3r> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var b=Object.defineProperty;var f=(c,o,i)=>o in c?b(c,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[o]=i;var l=(c,o,i)=>(f(c,typeof o!="symbol"?o+"":o,i),i);var p;{let c={0:t=>m(t),1:t=>i(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(i(t)),5:t=>new Set(i(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[e,r]=t;return e in c?c[e](r):void 0},i=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,r])=>[e,o(r)]));customElements.get("astro-island")||customElements.define("astro-island",(p=class extends HTMLElement{constructor(){super(...arguments);l(this,"Component");l(this,"hydrator");l(this,"hydrate",async()=>{var d;if(!this.hydrator||!this.isConnected)return;let e=(d=this.parentElement)==null?void 0:d.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let r=this.querySelectorAll("astro-slot"),a={},h=this.querySelectorAll("template[data-astro-template]");for(let n of h){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("data-astro-template")||"default"]=n.innerHTML,n.remove())}for(let n of r){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("name")||"default"]=n.innerHTML)}let u;try{u=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(n){let s=this.getAttribute("component-url")||"<unknown>",y=this.getAttribute("component-export");throw y&&(s+=` (export ${y})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),n),n}await this.hydrator(this)(this.Component,u,a,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});l(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),r.disconnect(),this.childrenConnectedCallback()},r=new MutationObserver(()=>{var a;((a=this.lastChild)==null?void 0:a.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});r.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}start(){let e=JSON.parse(this.getAttribute("opts")),r=this.getAttribute("client");if(Astro[r]===void 0){window.addEventListener(`astro:${r}`,()=>this.start(),{once:!0});return}Astro[r](async()=>{let a=this.getAttribute("renderer-url"),[h,{default:u}]=await Promise.all([import(this.getAttribute("component-url")),a?import(a):()=>()=>{}]),d=this.getAttribute("component-export")||"default";if(!d.includes("."))this.Component=h[d];else{this.Component=h;for(let n of d.split("."))this.Component=this.Component[n]}return this.hydrator=u,this.hydrate},e,this)}attributeChangedCallback(){this.hydrate()}},l(p,"observedAttributes",["props"]),p))}})();</script><astro-island uid="15BDLN" prefix="r0" component-url="/_astro/Comments.3DD71428.js" component-export="default" renderer-url="/_astro/client.Th_ss2k4.js" props="{&quot;slug&quot;:[0,&quot;csapp-2e-datalab&quot;],&quot;permalink&quot;:[0,&quot;https://blog.skywt.cn/posts/csapp-2e-datalab&quot;],&quot;data-astro-cid-4sn4zg3r&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Comments&quot;,&quot;value&quot;:true}" await-children=""><h2><i class="ri-discuss-line"></i> æš‚æ— è¯„è®º</h2><hr class="my-8"/><h2><i class="ri-discuss-line"></i> å‘è¡¨æ–°çš„è¯„è®º</h2><p class="mt-4 primary-color card p-2"><i class="ri-information-line"></i> <b>æ‰€æœ‰è¯„è®ºéƒ½å°†ç»è¿‡åšä¸»å®¡æ ¸ã€‚</b>è¯·å‹¿å¡«å†™æ— æ„ä¹‰é‚®ç®±æˆ–å‘è¡¨æ— å…³è¯„è®ºã€å¹¿å‘Šç­‰ï¼Œå¦åˆ™ä¼šè¢«è§†ä¸ºåƒåœ¾è¯„è®ºã€‚<br/>è¯„è®ºæäº¤ç»„ä»¶æ˜¯æœ€è¿‘åˆšå†™çš„ï¼Œå¦‚æœé‡åˆ° bug æ¬¢è¿å‘åšä¸»åé¦ˆï½</p><form class="mt-4 grid gap-4 grid-cols-1 sm:grid-cols-3 relative"><input placeholder="ä½ çš„åå­—" type="text" required="" value=""/><input placeholder="é‚®ç®±" type="email" required="" value=""/><input placeholder="ç½‘å€" type="url" value=""/><textarea rows="8" class="sm:col-span-3" placeholder="è¯´ç‚¹ä»€ä¹ˆå§â€¦â€¦" required=""></textarea><button type="submit" class="sm:col-span-3">æäº¤</button></form><p class="mt-4 secondary-color text-sm leading-normal">æäº¤è¯„è®ºå³è¡¨æ˜ä½ åŒæ„æœ¬ç½‘ç«™ä½¿ç”¨ Cookieï¼Œå¹¶å…è®¸æœ¬ç«™åœ¨åå°è®°å½•ä½ çš„é‚®ç®±ã€IP åœ°å€ç­‰å¿…è¦ä¿¡æ¯ã€‚<br/>ï¼ˆæäº¤ä¸€æ¬¡è¯„è®ºåï¼Œæœ¬æç¤ºå°†ä¸å†å±•ç¤ºï¼‰</p><!--astro:end--></astro-island> </section> </main>  <footer class="mt-16 py-8 bg-gray-100 dark:bg-neutral-900"> <div class="wide-container secondary-color text-sm"> <div class="flex justify-between flex-wrap"> <div class="m-2"> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> åšå®¢</a> </span><span>
/
CSAPP 2e Datalab é¢˜è§£ </span> </div> <div class="m-2"> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> 
ä¸»é¡µ
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv>  åšå®¢ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv>  å®éªŒå®¤ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv>  å‹äºº </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv>  å…³äº </a> </li> </ul>  </div> </div> <hr class="my-4"> <div class="flex justify-between flex-wrap"> <p class="m-2">
&#169; 2017-2024 <a href="/" class="link">SkyWT</a>
|
<a href="/sitemap.xml" class="link">ç«™ç‚¹åœ°å›¾</a>
|
<a href="/friends" class="link">å‹æƒ…é“¾æ¥</a>
|
<a href="https://foreverblog.cn/go.html" class="link">è™«æ´</a> <!-- |
        <a href="https://github.com/Skywt2003/Daydreamer" class="link"
          >Daydreamer</a
        > --> </p> <div class="m-2"> <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" class="inline-block mx-1" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/cc.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/by.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/nc.svg" data-astro-cid-h3ykra2n>   </a>  <a href="https://notbyai.fyi" target="_blank" class="inline-block mx-1" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-light.svg" alt="Not By AI Badge" class="badge inline-block dark:hidden" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-dark.svg" alt="Not By AI Badge" class="badge hidden dark:inline-block" data-astro-cid-hwbnc4sm> </a>  <a href="https://www.foreverblog.cn/" target="_blank" class="inline-block mx-1"> <img src="https://img.foreverblog.cn/logo_en_default.png" alt="Forever Blog Badage" class="inline-block h-4 grayscale"> </a> </div> </div> <div class="flex justify-between flex-wrap"> <p class="m-2"> <a href="https://beian.miit.gov.cn/" target="_blank" class="link">
æµ™ ICP å¤‡ 2021019606 å· - 1</a>
|
<a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33080202000472" target="_blank" class="link before:content-[url('/mps.png')] before:align-middle">
æµ™å…¬ç½‘å®‰å¤‡ 33080202000472 å·</a> </p> <p class="m-2"> <!-- <span class="align-middle">ç”±</span>
        <a
          href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral"
          class="inline-block align-middle"
        >
          <img src="/upyun.png" class="h-6" />
        </a>
        <span class="align-middle">æä¾› CDN åŠ é€Ÿã€äº‘å­˜å‚¨æœåŠ¡</span> --> </p> </div> </div> </footer> </body></html> 