<!DOCTYPE html><html> <head><meta charset="UTF-8"><meta name="description" content="Astro description"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.1.1"><title>æœåŠ¡å™¨è‡ªåŠ¨åŒ–å¼‚åœ°å®¹ç¾å¤‡ä»½æ–¹æ¡ˆï¼ˆç™½å«–ç‰ˆï¼‰</title><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&display=swap"><!-- Matomo --><script>
      var _paq = (window._paq = window._paq || []);
      _paq.push(["trackPageView"]);
      _paq.push(["enableLinkTracking"]);
      (function () {
        var u = "//analytics.skywt.cn/";
        _paq.push(["setTrackerUrl", u + "matomo.php"]);
        _paq.push(["setSiteId", "1"]);
        var d = document,
          g = d.createElement("script"),
          s = d.getElementsByTagName("script")[0];
        g.async = true;
        g.src = u + "matomo.js";
        s.parentNode.insertBefore(g, s);
      })();
    </script><!-- End Matomo Code --><link rel="stylesheet" href="/_astro/about.FA4QTjbH.css" />
<style>img[data-astro-cid-4sn4zg3r]{border-radius:.25rem;--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}
</style>
<link rel="stylesheet" href="/_astro/friends.hRKOKN_Z.css" /></head> <body> <header class="mt-12 wide-container" data-astro-cid-3ef6ksr2> <h5 class="mt-4 mx-4 secondary-color sm:hidden text-center" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> åšå®¢</a> </span><span>
/
æœåŠ¡å™¨è‡ªåŠ¨åŒ–å¼‚åœ°å®¹ç¾å¤‡ä»½æ–¹æ¡ˆï¼ˆç™½å«–ç‰ˆï¼‰ </span> </h5> </header> <nav class="py-2 font-thin sticky top-0 backdrop-blur-md z-10 transition-all" id="navbar-wrapper" data-astro-cid-3ef6ksr2> <div class="wide-container flex justify-center sm:justify-between flex-wrap" data-astro-cid-3ef6ksr2> <h5 class="m-2 hidden sm:block secondary-color" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> åšå®¢</a> </span><span>
/
æœåŠ¡å™¨è‡ªåŠ¨åŒ–å¼‚åœ°å®¹ç¾å¤‡ä»½æ–¹æ¡ˆï¼ˆç™½å«–ç‰ˆï¼‰ </span> </h5> <div class="m-2 secondary-color" data-astro-cid-3ef6ksr2> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> <i class="ri-home-line" data-astro-cid-tfcnbjmv></i>
ä¸»é¡µ
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv> <i class="ri-newspaper-line" data-astro-cid-tfcnbjmv></i> åšå®¢ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv> <i class="ri-server-line" data-astro-cid-tfcnbjmv></i> å®éªŒå®¤ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv> <i class="ri-contacts-line" data-astro-cid-tfcnbjmv></i> å‹äºº </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv> <i class="ri-cup-line" data-astro-cid-tfcnbjmv></i> å…³äº </a> </li> </ul>  </div> </div> </nav> <script>
  const headerEl = document.querySelector("#navbar-wrapper");
  const sentinalEl = document.querySelector("header");
  const handler = (entries) => {
    if (!entries[0].isIntersecting) {
      headerEl.classList.add("sticked");
    } else {
      headerEl.classList.remove("sticked");
    }
  };
  const observer = new window.IntersectionObserver(handler);
  observer.observe(sentinalEl);
</script>   <main data-astro-cid-4sn4zg3r> <section class="container mt-8 sm:mt-32" data-astro-cid-4sn4zg3r>  <h1 class="primary-color leading-relaxed" data-astro-cid-4sn4zg3r>æœåŠ¡å™¨è‡ªåŠ¨åŒ–å¼‚åœ°å®¹ç¾å¤‡ä»½æ–¹æ¡ˆï¼ˆç™½å«–ç‰ˆï¼‰</h1> <p class="mt-4 secondary-color leading-relaxed" data-astro-cid-4sn4zg3r> <i class="ri-calendar-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>2022 å¹´ 06 æœˆ 20 æ—¥</span>   <br data-astro-cid-4sn4zg3r> <i class="ri-discuss-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>å…± 3 æ¡è¯„è®º</span>  </p> <hr class="my-8" data-astro-cid-4sn4zg3r> <p class="card p-2 my-8" data-astro-cid-4sn4zg3r>
âš™ï¸ å…¨æ–°åšå®¢å‰ç«¯ä»åœ¨æµ‹è¯•ä¸­ã€‚å¦‚æœæ–‡ç« æ˜¾ç¤ºä¸æ­£å¸¸ï¼Œå¯ä»¥å°è¯•è®¿é—®<a href="https://blog.skywt.cn/posts/automatic-remote-dr-solution-for-servers-free" class="link underline" data-astro-cid-4sn4zg3r>åŸåšå®¢çš„è¿™ç¯‡æ–‡ç« </a>ã€‚
</p> <article class="prose dark:prose-neutral dark:prose-invert max-w-none" data-astro-cid-4sn4zg3r> <p>éšç€è‡ªå·± Self-host çš„æœåŠ¡è¶Šæ¥è¶Šå¤šï¼ŒæœåŠ¡å™¨ä¸Šçš„æ•°æ®ä¹Ÿè¶Šæ¥è¶Šé‡è¦ã€‚è™½ç„¶æœåŠ¡å™¨å¾ˆå°‘æœ‰å®Œå…¨ crash æ‰çš„å¯èƒ½æ€§ï¼Œä½†æ˜¯å¦‚æœæŸå¤©çœŸçš„æœ‰ä»€ä¹ˆä¸å¯æŠ—åŠ›ï¼Œåæœæ˜¯ä¸å ªè®¾æƒ³çš„â€¦â€¦æ‰€ä»¥ä¸€ä¸ªè‡ªåŠ¨åŒ–ä¸”ç™½å«–çš„ã€Œå®¹ç¾å¤‡ä»½ã€æ–¹æ¡ˆå°±ååˆ†é‡è¦ã€‚</p><!--more--><p>çœŸæ­£æé†’æˆ‘å¼‚åœ°ã€Œå®¹ç¾å¤‡ä»½ã€çš„é‡è¦æ€§çš„æ˜¯æŸå¤©çœ‹åˆ°çš„ä¸€ä¸ª memeâ€¦â€¦</p><p><img src="https://blog.skywt.cn/usr/uploads/2022/06/1744578141.jpg" alt="Server has crashed..." title="Server has crashed..."></p><p>æŠŠè‡ªå·±æœåŠ¡å™¨çš„å¤‡ä»½æ”¾åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œå°±æ˜¯ç›¸å½“äºæ²¡æœ‰å¤‡ä»½ =_=</p><p>äºæ˜¯æˆ‘æ‰¾åˆ°äº† Storjã€Google Drive ä¸¤ä¸ªç™½å«–çš„å¤‡ä»½å»å¤„ï¼Œè®°å½•ä¸€ä¸‹é‡åˆ°çš„ä¸€äº›å‘ã€‚</p><h2>Restic + Rclone</h2><p>æˆ‘é€‰æ‹©äº† <a href="https://restic.net/">Restic</a> ä½œä¸ºå¤‡ä»½çš„è½¯ä»¶ã€‚Restic æ˜¯ä¸€ä¸ªå¼€æºçš„è½»é‡çº§å¤‡ä»½å·¥å…·ï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚</p><p>ä¸ºäº†å®ç°è¿œç¨‹çš„å­˜å‚¨ï¼Œæˆ‘ä½¿ç”¨ <a href="https://rclone.org/">Rclone</a> ä½œä¸º Restic çš„åç«¯ã€‚Rclone æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†äº‘å­˜å‚¨æ–‡ä»¶çš„å‘½ä»¤è¡Œç¨‹åºï¼Œæ”¯æŒéå¸¸å¤šçš„äº‘æœåŠ¡ã€‚</p><p>Resticã€Rclone çš„åŸºæœ¬ç”¨æ³•å¯ä»¥å‚é˜…å®˜ç½‘ï¼Œè¿™é‡Œä¸èµ˜è¿°ã€‚</p><h2>Storj</h2><p>Storj æ˜¯ä¸€å®¶äº‘å­˜å‚¨å‚å•†ï¼Œå…è´¹è®¡åˆ’æä¾› 150G çš„äº‘å­˜å‚¨å¯ä»¥ç™½å«–ï¼Œæ‹¿æ¥å­˜æ”¾å¤‡ä»½ç»°ç»°æœ‰ä½™ã€‚Rclone ä¹Ÿæ”¯æŒ Storjã€‚</p><p>ç›®å‰ Storj æ²¡æœ‰è¢«å¢™ï¼Œå³ä½¿æœåŠ¡å™¨åœ¨å›½å†…ä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</p><h3>Rclone æŒ‚è½½</h3><p>Storj æœ‰ä¸ªæ¦‚å¿µå«åš Access Grantï¼Œä¸€å¼€å§‹æˆ‘ä¹Ÿæœ‰ç‚¹è¿·ç³Šã€‚</p><p>åŸå§‹çš„ API key + passphrase çš„è®¤è¯æ–¹å¼æ˜¯åœ¨è¢«é€æ­¥å¼ƒç”¨çš„ã€‚æ‰€è°“ Access Grant æ˜¯ä¸€ä¸ªé•¿é•¿çš„å­—ç¬¦ä¸²ï¼Œä½œç”¨ç›¸å½“äº API key ä½†æ˜¯æ— éœ€å…¶ä»–éªŒè¯ï¼Œé€šè¿‡è¿™ä¸ªå¯ä»¥ç›´æ¥è¯æ˜å¯¹è‡ªå·±æŒ‡å®š Bucket çš„è®¿é—®æƒé™ã€‚åœ¨ Storj åå°å¯ä»¥ç”Ÿæˆ Access Grantsã€‚</p><p>æ‰€ä»¥åœ¨ <code>rclone config</code> åˆ°è¿™ä¸€æ­¥çš„æ—¶å€™ï¼š</p><pre><code class="lang-plaintext">Option provider.
Choose an authentication method.
Choose a number from below, or type in your own string value.
Press Enter for the default (existing).
 1 / Use an existing access grant.
   \ (existing)
 2 / Create a new access grant from satellite address, API key, and passphrase.
   \ (new)</code></pre><p>åº”è¯¥é€‰æ‹© 1ï¼Œç„¶åç²˜è´´åå°ç”Ÿæˆçš„ Access Grantã€‚</p><h3>Restic with Rclone</h3><p>åˆå§‹åŒ– Restic å­˜å‚¨åº“ï¼Œè®°å¾—è®¾ç½®ä¸€ä¸ªéšæœºçš„çŒœä¸åˆ°çš„å¯†ç ï¼š</p><pre><code class="lang-bash">restic -r rclone:storj:server-dr/backup init</code></pre><p>å…¶ä¸­ <code>storj</code> æ˜¯ <code>rclone config</code> æ—¶è®¾ç½®çš„ remote åç§°ï¼Œ<code>server-dr</code> æ˜¯ Storj ä¸Šçš„ Bucket åç§°ï¼Œ<code>/backup</code> æ‰æ˜¯è‡ªå·±æŒ‡å®šçš„ç›®å½•ã€‚</p><p>è¿™ä¸€æ­¥å®Œæˆåï¼Œæµè§ˆå™¨è¿›å…¥ Storj çš„åå°æ–‡ä»¶ç®¡ç†ï¼Œå°±å¯ä»¥çœ‹è§ <code>server-dr</code> è¿™ä¸ª Bucket ä¸­å¤šäº†ä¸€ä¸ª <code>backup</code> æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­å°±æ˜¯åˆå§‹åŒ–çš„ Restic å¤‡ä»½ä»“åº“ã€‚</p><p>è¿›è¡Œå¤‡ä»½ï¼š</p><pre><code class="lang-bash">restic backup /data -r rclone:storj:server-dr/backup --verbose</code></pre><p>åˆ é™¤è¿‡æœŸå¿«ç…§ï¼Œåªä¿ç•™æœ€è¿‘ä¸‰å¤©çš„å¤‡ä»½ï¼š</p><pre><code class="lang-bash">restic forget --keep-daily 3 --prune -r rclone:storj:server-dr/backup</code></pre><p>ç¬¬ä¸€æ¬¡å¤‡ä»½ä¼šæ¯”è¾ƒæ…¢ï¼Œå…± 3G å·¦å³çš„å†…å®¹ï¼Œæˆ‘çš„ç¬¬ä¸€æ¬¡å¤‡ä»½ç”¨äº†ä¸‰ä¸ªå¤šå°æ—¶â€¦â€¦ä¹‹åçš„å¤‡ä»½å°±éƒ½ä¼šæ˜¯å¢é‡å¤‡ä»½ï¼Œä¼šå¾ˆå¿«ã€‚</p><h2>Google Drive</h2><p>Rclone ä¹Ÿæ”¯æŒ Google Driveï¼Œå…è´¹ç©ºé—´ 15Gï¼Œä¹Ÿæ˜¯ä¸€ç§ç»ä½³çš„ç™½å«–æ–¹æ¡ˆã€‚åªä¸è¿‡å¦‚æœæ˜¯å›½å†…çš„æœåŠ¡å™¨çš„è¯è¦å¼€ä»£ç†ã€‚</p><p>ç±»ä¼¼çš„é€‰æ‹©è¿˜æœ‰ Onedriveï¼ˆç©ºé—´å°ï¼Œå…è´¹è®¡åˆ’åªæœ‰ 5Gï¼‰ã€Dropboxï¼ˆä¹Ÿè¦å¼€ä»£ç†ï¼‰ï¼ŒRclone ä¹Ÿéƒ½æ”¯æŒï¼Œå¯ä»¥å°è¯•ã€‚</p><p>ä½¿ç”¨å’Œä¸Šè¿° Storj ç±»ä¼¼ï¼Œ<code>rclone config</code> ä¹‹åï¼›</p><pre><code class="lang-bash">restic -r rclone:gdrive:/backup init

restic backup /data -r rclone:gdrive:/backup --verbose --password-file /root/backup/password_gdrive &gt; /root/backup/backup_gdrive.log
restic forget --keep-daily 3 --prune -r rclone:gdrive:/backup</code></pre><h3>è‡ªå·±çš„ client-id</h3><p>åœ¨åˆ›å»º Google Drive çš„ remote æ—¶ï¼Œrclone æ¨èä½ å»ç”³è¯·è‡ªå·±çš„ client idï¼Œå‚ç…§<a href="https://rclone.org/drive/#making-your-own-client-id">è¿™ä¸ªæ–‡æ¡£</a>ã€‚</p><p>æœ‰ä¸€ä¸ªå°å‘ç‚¹ï¼Œæ ¹æ®è¿™ä¸ªæ–‡æ¡£ç”³è¯·æˆåŠŸä¹‹åï¼Œå›åˆ° Rclone çš„ç™»å½•æ­¥éª¤æ—¶ï¼Œç”±äºæˆ‘çš„æœåŠ¡å™¨æ˜¯ headless çš„ï¼Œæˆ‘å°±ç”¨æœ¬åœ°çš„ rclone è¿›è¡Œç™»å½•æ“ä½œï¼Œè¿™æ—¶å€™ç»ˆç«¯ rclone ä¹Ÿè¦å¼€å¯ä»£ç†ï¼Œå¦åˆ™å³ä½¿ç™»å½•æˆåŠŸäº† get code æ“ä½œä¹Ÿæ˜¯æ‹¿ä¸åˆ° code çš„ï¼ˆä¹Ÿå°±æ˜¯æ˜¾ç¤º got code ä½†æ˜¯å´æ²¡æœ‰è¾“å‡º codeï¼Œå›°æƒ‘äº†æˆ‘å¥½ä¹…ï¼‰ã€‚</p><h2>å¦ä¸€å°æœåŠ¡å™¨ï¼ˆSFTPï¼‰</h2><p>å¦‚æœè¦å¤‡ä»½åˆ°å¦ä¸€å°æœåŠ¡å™¨ï¼Œæ— éœ€ Rcloneï¼ŒRestic è‡ªå¸¦äº† SFTP åè®®è¿æ¥ï¼Œåªè¦ç›®æ ‡ä¸»æœºå¼€å¯äº† SSH å°±è¡Œã€‚</p><pre><code class="lang-bash">restic -r sftp:user@host:/srv/restic-repo init</code></pre><p>å¦‚æœè‡ªå·±æ­å»ºäº† NASï¼Œä¹Ÿå¯ä»¥ç”¨ SFTP å¤‡ä»½ã€‚</p><h2>è½¯å¤‡ä»½æ•°æ®åº“</h2><p>å¯¹äº MySQL æ•°æ®åº“ï¼Œé‡‡ç”¨ã€Œç¡¬å¤‡ä»½ã€æˆ–ç§°ä¸ºã€Œç‰©ç†å¤‡ä»½ã€çš„æ–¹å¼ï¼ˆå³ç›´æ¥å¤‡ä»½æ•´ä¸ª MySQL æ•°æ®å­˜æ”¾çš„æ–‡ä»¶å¤¹ï¼‰æ˜¯æœ‰ä¸€å®šçš„é£é™©çš„ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æŸåã€‚</p><p>ä¸ºäº†å®‰å…¨æ€§ï¼Œæˆ‘ä»¬å†å¢åŠ ä¸€ä¸ªã€Œè½¯å¤‡ä»½ã€ï¼Œç”¨ <code>mysqldump</code> å¯¼å‡º MySQL çš„æ•°æ®åˆ°ä¸€ä¸ª <code>.sql</code> æ–‡ä»¶é‡Œï¼Œå†å¤‡ä»½è¿™ä¸ªæ–‡ä»¶ã€‚</p><pre><code class="lang-bash"># å¤‡ä»½æŒ‡å®šæ•°æ®åº“
mysqldump -u username -p db_name &gt; mydb.sql
# å¤‡ä»½æ‰€æœ‰æ•°æ®åº“
mysqldump -u username -p --all-databases &gt; alldb.sql
# å¤‡ä»½ Docker å®¹å™¨ä¸­çš„æ•°æ®åº“
bash -c &quot;docker exec mariadb mysqldump -u username --password=password --all-databases&quot; &gt; mysql_all.sql</code></pre><h2>è‡ªåŠ¨åŒ–è„šæœ¬</h2><p>å¯ä»¥æŠŠä»¥ä¸Šæ“ä½œå†™åˆ°ä¸€ä¸ª <code>backup.sh</code> è„šæœ¬é‡Œï¼Œè®¾ç½®ä»¥ä¸‹ Crontab è§„åˆ™æ¯å¤©å‡Œæ™¨ 3:00 å®šæ—¶æ‰§è¡Œå¤‡ä»½ï¼š</p><pre><code>0 3 * * * /root/backup/backup.sh &gt; /root/backup/backup.log</code></pre><p>æˆ‘å†™çš„è„šæœ¬å¦‚ä¸‹ï¼š</p><pre><code class="lang-bash">#!/bin/bash
# Author: SkyWT

# å·²ç»åˆå§‹åŒ–çš„ RESTIC ä»“åº“
RESTIC_REPO=(
  &quot;rclone:storj:server-dr/backup&quot;
  &quot;rclone:gdrive:/backup&quot;
#  &quot;sftp://root@localhost:7051//data/tc_backup&quot;
)
# å„ä¸ªä»“åº“æ˜¯å¦éœ€è¦ä»£ç†
RESTIC_PROXY_NEEDED=(
  &quot;false&quot;
  &quot;true&quot;
)
# å„ä¸ªä»“åº“çš„å¯†ç 
RESTIC_PASS=(
  &quot;YourPassWord&quot;
  &quot;YourPassWord&quot;
)

# è®¾ç½®ç½‘ç»œä»£ç†çš„åœ°å€
BACKUP_PROXY=&quot;http://127.0.0.1:10800&quot;

# å¤‡ä»½ MySQL çš„ç›¸å…³é…ç½®
BACKUP_MYSQL=true
MYSQL_CONTAINER_NAME=mariadb
MYSQL_ROOT_NAME=root
MYSQL_ROOT_PASS=YourPassWord

# å¤‡ä»½æ–‡ä»¶çš„ç›¸å…³é…ç½®
BACKUP_FILES=true
# éœ€è¦å¤‡ä»½çš„æ–‡ä»¶/æ–‡ä»¶å¤¹
FILES_TARGET=(
  &quot;/data&quot;
)

# æ¸…ç†æ—§å¿«ç…§çš„ç›¸å…³é…ç½®
BACKUP_FORGET=true
# å¿«ç…§çš„ä¿ç•™ç­–ç•¥ï¼Œå¯å‚é˜… Restic æ–‡æ¡£
FORGET_POLICY_ARG=&quot;--keep-daily 3&quot;

# ----- END OF CONFIG -----

set_proxy(){
    export http_proxy=$BACKUP_PROXY
    export https_proxy=$BACKUP_PROXY
}

unset_proxy(){
    unset http_proxy
    unset https_proxy
}

backup_mysql(){
    echo -e &quot;\e[32m --- Backup MySQL Start. --- \e[0m&quot;
    repo=$1
    bash -c &quot;docker exec $MYSQL_CONTAINER_NAME mysqldump -u $MYSQL_ROOT_NAME --password=$MYSQL_ROOT_PASS --all-databases&quot; &gt; mysql_all.sql
    restic -r $repo --verbose backup mysql_all.sql --password-file /tmp/.tmp_restic_pass
    echo -e &quot;\e[32m --- Backup MySQL OK. --- \e[0m&quot;
}

backup_files(){
    echo -e &quot;\e[32m --- Backup files Start. --- \e[0m&quot;
    repo=$1
    for target in ${FILES_TARGET[@]}
    do
        restic -r $repo --verbose backup $target --password-file /tmp/.tmp_restic_pass
    done
    echo -e &quot;\e[32m --- Backup files OK. --- \e[0m&quot;
}

backup_forget(){
    echo -e &quot;\e[32m --- Forget Start. --- \e[0m&quot;
    repo=$1
    bash -c &quot;restic -r $repo forget $FORGET_POLICY_ARG --password-file /tmp/.tmp_restic_pass --prune&quot;
    echo -e &quot;\e[32m --- Forget OK. --- \e[0m&quot;
}

start_time=$(date +%s)
for ((i=0; i&lt;${#RESTIC_REPO[@]}; i++));
do
    echo -e &quot;\e[32m --- Starting a repo. --- \e[0m&quot;
    repo=${RESTIC_REPO[$i]}
    echo ${RESTIC_PASS[$i]} &gt; /tmp/.tmp_restic_pass
    if ${RESTIC_PROXY_NEEDED[$i]}; then set_proxy; fi

    if $BACKUP_MYSQL; then backup_mysql $repo; fi
    if $BACKUP_FILES; then backup_files $repo; fi
    if $BACKUP_FORGET; then backup_forget $repo; fi

    if ${RESTIC_PROXY_NEEDED[$i]}; then unset_proxy; fi
    rm -rf /tmp/.tmp_restic_pass
    echo -e &quot;\e[32m --- Ending a repo. --- \e[0m&quot;
done
end_time=$(date +%s)
cost_time=$[ $end_time-$start_time ]

echo -e &quot;\e[32m Done in $cost_time s.  \e[0m&quot;</code></pre><h2>ç»“è¯­</h2><p>å¯¹äº Self-hosted ç©å®¶æ¥è¯´ï¼Œæ²¡æœ‰ä»€ä¹ˆæ¯”æ•°æ®æ›´å®è´µäº†ã€‚è™½ç„¶æŠ˜è…¾èµ·æ¥æœ‰ç‚¹éº»çƒ¦ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰åˆé€‚çš„å¤‡ä»½æ–¹æ¡ˆï¼Œç­‰æœåŠ¡å™¨ crash çš„æ—¶å€™çœŸçš„ä¼šè¿½æ‚”è«åŠã€‚</p><p>è™½ç„¶æˆ‘æ²¡æœ‰ç»å†è¿‡ï¼Œä½†æ˜¯æˆ‘è¯´å®è¯æ²¡åŠæ³•ä¿è¯æœåŠ¡å™¨åœ¨ä¸‹ä¸€ç§’ä¼šä¸ä¼šå› ä¸ºä»€ä¹ˆä¸å¯æŠ—åŠ›è€Œ crashï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚æœ‰å¤ªå¤šä¸œè¥¿æ˜¯æˆ‘ä»¬æ— æ³•æ§åˆ¶çš„ã€‚æˆ‘ä»¬åªèƒ½åšå¥½æˆ‘ä»¬èƒ½æ§åˆ¶çš„ä¸€åˆ‡ã€‚</p> </article> <hr class="my-8" data-astro-cid-4sn4zg3r> <h2> <i class="ri-discuss-line"></i> å…± 3 æ¡è¯„è®º </h2> <div class="primary-color my-4"> <div class="flex items-center"> <img src="https://gravatar.com/avatar/04cbc6f1f5ee0e2475e07cb81cc2f7ab" class="rounded-full w-12 mr-2"> <div class="m-2"> <a href="https://gxzv.com" class="link" target="_blank"> <h4>Ganxiaozhe</h4> </a> <p class="mt-1">2022 å¹´ 6 æœˆ 21 æ—¥ 16:58</p> </div> </div> <p class="mt-2 break-all">azï¼Œæ‹–å»¶ä¸€ç›´ä½¿æˆ‘æ‡’å¾—å»æŠ˜è…¾å®¹ç¾å¤‡ä»½ï¼Œä¹‹å‰æƒ³çš„å°±åªæ˜¯å†™ä¸ªè„šæœ¬æ¯å¤©å®šæ—¶è¿è¡Œä¸€æ¬¡ï¼šæ‰“åŒ…ç›®å½•ä¸‹å˜åŠ¨çš„æ–‡ä»¶å’Œ SQL æ•°æ®ä¼ ç»™ NASï¼ŒNAS åç«¯æ¥æ”¶ååˆ†ç±»ä¿å­˜ã€‚
å¤´ä¸€æ¬¡çŸ¥é“ Restic å’Œ Rcloneï¼Œæ™ƒäº†çœ¼ doc å¥½åƒè›®é¦™ï¼Œå…ˆ mark ä¸€ä¸‹ &lt;3</p> <div class="ml-8"> <div class="primary-color my-4"> <div class="flex items-center"> <img src="https://gravatar.com/avatar/5e41558bb32a2583cb14e6940b9b62ed" class="rounded-full w-12 mr-2"> <div class="m-2"> <a href="https://skywt.cn/" class="link" target="_blank"> <h4>SkyWT</h4> </a> <p class="mt-1">2022 å¹´ 6 æœˆ 22 æ—¥ 4:14</p> </div> </div> <p class="mt-2 break-all">å…¶å®æˆ‘è‡ªå·±ä¹Ÿæ‹–äº†å¾ˆä¹… OvO
æˆ‘ä¸»è¦æ˜¯å¤§å­¦å¯å®¤é‡Œæ²¡æ¡ä»¶æ­ NASï¼Œæ‰€ä»¥æ‰å»ç™½å«–äº‘å­˜å‚¨â€¦â€¦ä¸ç„¶è‚¯å®šæ”¾åœ¨è‡ªå·±çš„ NAS é‡Œæ›´å®‰å…¨â€¦â€¦</p> <div class="ml-8">  </div> </div> </div> </div><div class="primary-color my-4"> <div class="flex items-center"> <img src="https://gravatar.com/avatar/d38dbe020d4183f7f70fde5c1d0ac1a2" class="rounded-full w-12 mr-2"> <div class="m-2"> <h4>æ±¤åœ†</h4> <p class="mt-1">2022 å¹´ 6 æœˆ 21 æ—¥ 12:3</p> </div> </div> <p class="mt-2 break-all">æ‰“å¡ğŸ˜‹</p> <div class="ml-8">  </div> </div> <hr class="my-8"> <h2> <i class="ri-discuss-line"></i>
å‘è¡¨è¯„è®º
</h2> <p class="primary-color card my-4 p-2">
ğŸš§ æ–°åšå®¢ç³»ç»Ÿçš„è¯„è®ºåŠŸèƒ½ä»åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ã€‚å¯ä»¥å‰å¾€<a href="https://blog.skywt.cn/posts/automatic-remote-dr-solution-for-servers-free" class="link underline">åŸåšå®¢çš„è¿™ç¯‡æ–‡ç« </a>åº•éƒ¨è¯„è®ºåŒºå‘è¡¨è¯„è®ºã€‚
</p> </section> </main>  <footer class="mt-16 py-8 bg-gray-100 dark:bg-neutral-900"> <div class="wide-container secondary-color text-sm"> <div class="flex justify-between flex-wrap"> <div class="m-2"> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> åšå®¢</a> </span><span>
/
æœåŠ¡å™¨è‡ªåŠ¨åŒ–å¼‚åœ°å®¹ç¾å¤‡ä»½æ–¹æ¡ˆï¼ˆç™½å«–ç‰ˆï¼‰ </span> </div> <div class="m-2"> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> 
ä¸»é¡µ
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv>  åšå®¢ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv>  å®éªŒå®¤ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv>  å‹äºº </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv>  å…³äº </a> </li> </ul>  </div> </div> <hr class="my-4"> <div class="flex justify-between flex-wrap"> <p class="m-2">
&#169; 2017-2024 <a href="/" class="link">SkyWT</a>
|
<a href="/sitemap.xml" class="link">ç«™ç‚¹åœ°å›¾</a>
|
<a href="/friends" class="link">å‹æƒ…é“¾æ¥</a>
|
<a href="https://foreverblog.cn/go.html" class="link">è™«æ´</a> <!-- |
        <a href="https://github.com/Skywt2003/Daydreamer" class="link"
          >Daydreamer</a
        > --> </p> <div class="m-2"> <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" class="inline-block mx-1" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/cc.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/by.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/nc.svg" data-astro-cid-h3ykra2n>   </a>  <a href="https://notbyai.fyi" target="_blank" class="inline-block mx-1" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-light.svg" alt="Not By AI Badge" class="badge inline-block dark:hidden" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-dark.svg" alt="Not By AI Badge" class="badge hidden dark:inline-block" data-astro-cid-hwbnc4sm> </a>  <a href="https://www.foreverblog.cn/" target="_blank" class="inline-block mx-1"> <img src="https://img.foreverblog.cn/logo_en_default.png" alt="Forever Blog Badage" class="inline-block h-4 grayscale"> </a> </div> </div> <div class="flex justify-between flex-wrap"> <p class="m-2"> <a href="https://beian.miit.gov.cn/" target="_blank" class="link">
æµ™ ICP å¤‡ 2021019606 å· - 1</a>
|
<a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33080202000472" target="_blank" class="link before:content-[url('/mps.png')] before:align-middle">
æµ™å…¬ç½‘å®‰å¤‡ 33080202000472 å·</a> </p> <p class="m-2"> <!-- <span class="align-middle">ç”±</span>
        <a
          href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral"
          class="inline-block align-middle"
        >
          <img src="/upyun.png" class="h-6" />
        </a>
        <span class="align-middle">æä¾› CDN åŠ é€Ÿã€äº‘å­˜å‚¨æœåŠ¡</span> --> </p> </div> </div> </footer> </body></html> 