<!DOCTYPE html><html> <head><meta charset="UTF-8"><meta name="description" content="Astro description"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.1.1"><title>CodeForces 274D Lovely Matrixï¼šâ€œå†—ä½™ç‚¹â€ å»ºè¾¹ + æ‹“æ‰‘</title><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&display=swap"><!-- Matomo --><script>
      var _paq = (window._paq = window._paq || []);
      _paq.push(["trackPageView"]);
      _paq.push(["enableLinkTracking"]);
      (function () {
        var u = "//analytics.skywt.cn/";
        _paq.push(["setTrackerUrl", u + "matomo.php"]);
        _paq.push(["setSiteId", "1"]);
        var d = document,
          g = d.createElement("script"),
          s = d.getElementsByTagName("script")[0];
        g.async = true;
        g.src = u + "matomo.js";
        s.parentNode.insertBefore(g, s);
      })();
    </script><!-- End Matomo Code --><link rel="stylesheet" href="/_astro/about.42xRgEnE.css" />
<style>img[data-astro-cid-4sn4zg3r]{border-radius:.25rem;--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}
</style>
<link rel="stylesheet" href="/_astro/friends.hRKOKN_Z.css" /></head> <body> <header class="mt-12 wide-container" data-astro-cid-3ef6ksr2> <h5 class="mt-4 mx-4 secondary-color sm:hidden text-center" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> åšå®¢</a> </span><span>
/
CodeForces 274D Lovely Matrixï¼šâ€œå†—ä½™ç‚¹â€ å»ºè¾¹ + æ‹“æ‰‘ </span> </h5> </header> <nav class="py-2 font-thin sticky top-0 backdrop-blur-md z-10 transition-all" id="navbar-wrapper" data-astro-cid-3ef6ksr2> <div class="wide-container flex justify-center sm:justify-between flex-wrap" data-astro-cid-3ef6ksr2> <h5 class="m-2 hidden sm:block secondary-color" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> åšå®¢</a> </span><span>
/
CodeForces 274D Lovely Matrixï¼šâ€œå†—ä½™ç‚¹â€ å»ºè¾¹ + æ‹“æ‰‘ </span> </h5> <div class="m-2 secondary-color" data-astro-cid-3ef6ksr2> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> <i class="ri-home-line" data-astro-cid-tfcnbjmv></i>
ä¸»é¡µ
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv> <i class="ri-newspaper-line" data-astro-cid-tfcnbjmv></i> åšå®¢ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv> <i class="ri-server-line" data-astro-cid-tfcnbjmv></i> å®éªŒå®¤ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv> <i class="ri-contacts-line" data-astro-cid-tfcnbjmv></i> å‹äºº </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv> <i class="ri-cup-line" data-astro-cid-tfcnbjmv></i> å…³äº </a> </li> </ul>  </div> </div> </nav> <script>
  const headerEl = document.querySelector("#navbar-wrapper");
  const sentinalEl = document.querySelector("header");
  const handler = (entries) => {
    if (!entries[0].isIntersecting) {
      headerEl.classList.add("sticked");
    } else {
      headerEl.classList.remove("sticked");
    }
  };
  const observer = new window.IntersectionObserver(handler);
  observer.observe(sentinalEl);
</script>   <main data-astro-cid-4sn4zg3r> <section class="container mt-32" data-astro-cid-4sn4zg3r>  <h1 class="primary-color leading-relaxed" data-astro-cid-4sn4zg3r>CodeForces 274D Lovely Matrixï¼šâ€œå†—ä½™ç‚¹â€ å»ºè¾¹ + æ‹“æ‰‘</h1> <p class="mt-4 secondary-color leading-relaxed" data-astro-cid-4sn4zg3r> <i class="ri-calendar-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>2018 å¹´ 08 æœˆ 06 æ—¥</span>   <br data-astro-cid-4sn4zg3r> <i class="ri-discuss-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>å…± 0 æ¡è¯„è®º</span>  </p> <hr class="my-8" data-astro-cid-4sn4zg3r> <p class="card p-2 my-8" data-astro-cid-4sn4zg3r>
âš™ï¸ å…¨æ–°åšå®¢å‰ç«¯ä»åœ¨æµ‹è¯•ä¸­ã€‚å¦‚æœæ–‡ç« æ˜¾ç¤ºä¸æ­£å¸¸ï¼Œå¯ä»¥å°è¯•è®¿é—®<a href="https://blog.skywt.cn/posts/cf274d" class="link underline" data-astro-cid-4sn4zg3r>åŸåšå®¢çš„è¿™ç¯‡æ–‡ç« </a>ã€‚
</p> <article class="prose dark:prose-neutral dark:prose-invert max-w-none" data-astro-cid-4sn4zg3r> <p>é¢˜ç›®é“¾æ¥ï¼š<a href="http://codeforces.com/problemset/problem/274/D" title="CodeForces 274D Lovely Matrix">CodeForces 274D Lovely Matrix</a><br>ä»Šå¤©çœ‹<a href="http://codeforces.com/blog/entry/6759" title="CFå®˜æ–¹é¢˜è§£">CFå®˜æ–¹é¢˜è§£</a>çš„æ—¶å€™å­¦æ¥ä¸€å¥è¯ï¼Œæš´åŠ›è§£æ³•ç§°ä¸º â€œThe naÃ¯ve solutionâ€ :joy:</p><!--more--><h2>Problem</h2><p>Lenny had an nâ€‰Ã—â€‰m matrix of positive integers. He loved the matrix so much, because each row of the matrix was sorted in non-decreasing order. For the same reason he calls such matrices of integers lovely.</p><p>One day when Lenny was at school his little brother was playing with Lenny's matrix in his room. He erased some of the entries of the matrix and changed the order of some of its columns. When Lenny got back home he was very upset. Now Lenny wants to recover his matrix.</p><p>Help him to find an order for the columns of the matrix so that it's possible to fill in the erased entries of the matrix to achieve a lovely matrix again. Note, that you can fill the erased entries of the matrix with any integers.</p><h2>Input</h2><p>The first line of the input contains two positive integers n and m $(1â€‰â‰¤â€‰nÂ·mâ€‰â‰¤â€‰10^5)$. Each of the next n lines contains m space-separated integers representing the matrix. An integer -1 shows an erased entry of the matrix. All other integers (each of them is between $0$ and $10^9$ inclusive) represent filled entries.</p><h2>Output</h2><p>If there exists no possible reordering of the columns print -1. Otherwise the output should contain m integers $p_1,â€‰p_2,â€‰...,â€‰p_m$ showing the sought permutation of columns. So, the first column of the lovely matrix will be p1-th column of the initial matrix, the second column of the lovely matrix will be $p_2$-th column of the initial matrix and so on.</p><h2>Examples</h2><h3>Input #1</h3><pre><code>3 3
1 -1 -1
1 2 1
2 -1 1

</code></pre><h3>Output #1</h3><pre><code>3 1 2 

</code></pre><h3>Input #2</h3><pre><code>2 3
1 2 2
2 5 4

</code></pre><h3>Output #2</h3><pre><code>1 3 2 

</code></pre><h3>Input #3</h3><pre><code>2 3
1 2 3
3 2 1

</code></pre><h3>Output #3</h3><pre><code>-1

</code></pre><h2>Translation</h2><p>ç»™ä½ ä¸€ä¸ª n è¡Œ m åˆ—çš„çŸ©é˜µï¼Œå…¶ä¸­ -1 å¯ä»¥æ¢æˆä»»ä½•æ•°å­—ã€‚è¦ä½ é‡æ–°å®‰æ’è¿™äº›åˆ—çš„é¡ºåºï¼Œä½¿å¾—çŸ©é˜µæ¯è¡Œå•è°ƒä¸é™ã€‚å¦‚æœåšä¸åˆ°åˆ™è¾“å‡º -1ã€‚</p><h2>Analysis</h2><p>çœ‹åˆ°è¿™é¢˜å¾ˆå®¹æ˜“æƒ³åˆ°æ˜¯æ‹“æ‰‘æ’åºï¼Œä½†æ˜¯å¯¹äºæ¯ä¸€è¡Œæˆ‘ä»¬éƒ½éœ€è¦ $N^2$ åœ°å»ºè¾¹ï¼Œæ˜¾ç„¶ä¼šè¶…æ—¶ã€‚è¿™æ—¶å€™å°±è¦ç”¨åˆ°ä¸€ä¸ªé»‘ç§‘æŠ€ï¼šåˆ©ç”¨å†—ä½™ç‚¹å»ºè¾¹ã€‚</p><p>å¯¹äºæ¯ä¸€è¡Œçš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®ƒå’Œç¬¬ä¸€ä¸ªæ¯”å®ƒå°çš„å…ƒç´ ä¹‹é—´å¢åŠ ä¸€ä¸ªâ€œå†—ä½™ç‚¹â€ï¼Œåœ¨å®ƒå’Œç¬¬ä¸€ä¸ªæ¯”å®ƒå¤§çš„å…ƒç´ ä¹‹é—´ä¹Ÿå»ºä¸€ä¸ªâ€œå†—ä½™ç‚¹â€ï¼Œç„¶åè®©å®ƒä¸è¿™ä¸¤ä¸ªâ€œå†—ä½™ç‚¹â€è¿è¾¹ã€‚å…¶å®å…·ä½“åœ¨å®ç°çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯å¯¹äºæ¯è¡Œçš„å…ƒç´ æ’åºåšçš„ï¼Œè¿™æ ·å»ºè¾¹æ—¶é—´å¤æ‚åº¦å°±é™åˆ° $\Theta (N\ast M)$ï¼Œä½†æ˜¯ç©ºé—´è¦å¼€ä¸¤å€ï¼ˆå› ä¸ºå¢åŠ çš„â€œå†—ä½™ç‚¹â€ä¹Ÿè¦åŠ å…¥æ‹“æ‰‘æ’åºï¼‰ã€‚è¿™æ˜¯ä¸€ç§å…¸å‹çš„ç©ºé—´æ¢æ—¶é—´çš„æ€æƒ³ã€‚</p><p>å»ºè¾¹æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="lang-cpp">inline void Build(int k){ // K ä»£è¡¨å½“å‰è¡Œï¼Œrcd[].x å­˜å‚¨äº†å·²ç»æ’å¥½åºçš„æ¯è¡Œæ•°æ®
    for (int i=1;i&lt;=m;i++) ans[i].id=i;
    int s=-1;bool fst=true; // fst æ ‡è®°æœ€å°çš„å…ƒç´ ï¼Œç”±äºæ²¡æœ‰æ¯”å…¶æ›´å°çš„å…ƒç´ ï¼Œæ‰€ä»¥å®ƒä¹‹å‰ä¸éœ€è¦å¢åŠ å†—ä½™ç‚¹ã€‚æœ€å¤§å…ƒç´ ä¹Ÿç±»ä¼¼ã€‚
    while (rcd[k][s+1].x==-1) s++; // å¯¹äº-1å¯ä»¥å¿½ç•¥ï¼Œä¸åŠ å…¥æ‹“æ‰‘æ’åº
    for (int i=s+1;i&lt;m;){ // æ’åºå»é‡çš„åšæ³•
        int j=i;cnt++;
        if (!fst) add(cnt-1+m,rcd[k][i].id);
        while (rcd[k][j+1].x==rcd[k][i].x&amp;&amp;j+1&lt;m){
            j++;
            if (!fst) add(cnt-1+m,rcd[k][j].id);
        }
        fst=false;
        if (j+1&lt;m) for (int t=i;t&lt;=j;t++) add(rcd[k][t].id,cnt+m);
        i=j+1;
    }
}</code></pre><h2>Code</h2><pre><code class="lang-cpp">#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;iostream&gt;
#include&lt;vector&gt;
#include&lt;queue&gt;
#include&lt;algorithm&gt;
using namespace std;
const int maxn=200005,maxe=400005;
int n,m,cnt=0;
int tot=0,lnk[maxn],nxt[maxe],son[maxe],ind[maxe];
struct WT{
    int x,id;
}ans[maxn];
vector&lt;int&gt; a[maxn];
vector&lt;WT&gt; rcd[maxn];
queue&lt;int&gt; que;

inline int read(){
    int ret=0,f=1;char ch=getchar();
    while (ch&lt;'0'||ch&gt;'9'){if (ch=='-') f=-1;ch=getchar();}
    while (ch&gt;='0'&amp;&amp;ch&lt;='9') ret=ret*10+ch-'0',ch=getchar();
    return ret*f;
}
inline void add(int x,int y){
    x++;y++;
    tot++;ind[y]++;son[tot]=y;nxt[tot]=lnk[x];lnk[x]=tot;
    //printf(&quot;Add an edge: %d  -&gt; %d\n&quot;,x,y);
}
inline bool cmp(WT aa,WT bb){
    return aa.x&lt;bb.x;
}
inline void Build(int k){
    for (int i=1;i&lt;=m;i++) ans[i].id=i;
    int s=-1;bool fst=true;
    while (rcd[k][s+1].x==-1) s++;
    for (int i=s+1;i&lt;m;){
        int j=i;cnt++;
        if (!fst) add(cnt-1+m,rcd[k][i].id);
        while (rcd[k][j+1].x==rcd[k][i].x&amp;&amp;j+1&lt;m){
            j++;
            if (!fst) add(cnt-1+m,rcd[k][j].id);
        }
        fst=false;
        if (j+1&lt;m) for (int t=i;t&lt;=j;t++) add(rcd[k][t].id,cnt+m);
        i=j+1;
    }
}
inline void Topology(){
    for (int i=1;i&lt;=m;i++) if (ind[i]==0) ans[i].x=1,que.push(i);
    while (!que.empty()){
        int x=que.front();que.pop();
        for (int i=lnk[x];i;i=nxt[i]){
            ind[son[i]]--;
            ans[son[i]].x=max(ans[son[i]].x,ans[x].x+bool(son[i]&lt;=m));
            if (ind[son[i]]==0) que.push(son[i]);
        }
    }
}
int main(){
    n=read();m=read();
    for (int i=1;i&lt;=n;i++){
        for (int j=0;j&lt;m;j++){
            int now=read();
            a[i].push_back(now);
            rcd[i].push_back((WT){now,j});
        }
        sort(rcd[i].begin(),rcd[i].end(),cmp);
    }
    for (int i=1;i&lt;=n;i++) Build(i);
    Topology();
    sort(ans+1,ans+1+m,cmp);
    if (ans[1].x==0){printf(&quot;-1\n&quot;);return 0;}
    for (int i=1;i&lt;=m;i++) printf(&quot;%d &quot;,ans[i].id);
    printf(&quot;\n&quot;);
    return 0;
}</code></pre> </article> <hr class="my-8" data-astro-cid-4sn4zg3r> <h2> <i class="ri-discuss-line"></i> å…± 0 æ¡è¯„è®º </h2>  <hr class="my-8"> <h2> <i class="ri-discuss-line"></i>
å‘è¡¨è¯„è®º
</h2> <p class="primary-color card my-4 p-2">
ğŸš§ æ–°åšå®¢ç³»ç»Ÿçš„è¯„è®ºåŠŸèƒ½ä»åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ã€‚å¯ä»¥å‰å¾€<a href="https://blog.skywt.cn/posts/cf274d" class="link underline">åŸåšå®¢çš„è¿™ç¯‡æ–‡ç« </a>åº•éƒ¨è¯„è®ºåŒºå‘è¡¨è¯„è®ºã€‚
</p> </section> </main>  <footer class="mt-16 py-8 bg-gray-100 dark:bg-neutral-900"> <div class="wide-container secondary-color text-sm"> <div class="flex justify-between flex-wrap"> <div class="m-2"> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> åšå®¢</a> </span><span>
/
CodeForces 274D Lovely Matrixï¼šâ€œå†—ä½™ç‚¹â€ å»ºè¾¹ + æ‹“æ‰‘ </span> </div> <div class="m-2"> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> 
ä¸»é¡µ
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv>  åšå®¢ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv>  å®éªŒå®¤ </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv>  å‹äºº </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv>  å…³äº </a> </li> </ul>  </div> </div> <hr class="my-4"> <div class="flex justify-between flex-wrap"> <p class="m-2">
&#169; 2017-2024 <a href="/" class="link">SkyWT</a>
|
<a href="/sitemap.xml" class="link">ç«™ç‚¹åœ°å›¾</a>
|
<a href="/friends" class="link">å‹æƒ…é“¾æ¥</a>
|
<a href="https://foreverblog.cn/go.html" class="link">è™«æ´</a> <!-- |
        <a href="https://github.com/Skywt2003/Daydreamer" class="link"
          >Daydreamer</a
        > --> </p> <div class="m-2"> <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" class="inline-block mx-1" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/cc.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/by.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/nc.svg" data-astro-cid-h3ykra2n>   </a>  <a href="https://notbyai.fyi" target="_blank" class="inline-block mx-1" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-light.svg" alt="Not By AI Badge" class="badge inline-block dark:hidden" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-dark.svg" alt="Not By AI Badge" class="badge hidden dark:inline-block" data-astro-cid-hwbnc4sm> </a>  <a href="https://www.foreverblog.cn/" target="_blank" class="inline-block mx-1"> <img src="https://img.foreverblog.cn/logo_en_default.png" alt="Forever Blog Badage" class="inline-block h-4 grayscale"> </a> </div> </div> <div class="flex justify-between flex-wrap"> <p class="m-2"> <a href="https://beian.miit.gov.cn/" target="_blank" class="link">
æµ™ ICP å¤‡ 2021019606 å· - 1</a>
|
<a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33080202000472" target="_blank" class="link before:content-[url('/mps.png')] before:align-middle">
æµ™å…¬ç½‘å®‰å¤‡ 33080202000472 å·</a> </p> <p class="m-2"> <span class="align-middle">ç”±</span> <a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" class="inline-block align-middle"> <img src="/upyun.png" class="h-6"> </a> <span class="align-middle">æä¾› CDN åŠ é€Ÿã€äº‘å­˜å‚¨æœåŠ¡</span> </p> </div> </div> </footer> </body></html> 